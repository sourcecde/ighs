<?php

/*
Gibbon, Flexible & Open School System
Copyright (C) 2010, Ross Parker

This program is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program. If not, see <http://www.gnu.org/licenses/>.
*/


//USE ;end TO SEPERATE SQL STATEMENTS. DON'T USE ;end IN ANY OTHER PLACES!

$sql=array() ;
$count=0 ;

//v5.0.00 and earlier
//Removed to reduce file size

//v6.0.00
$count++ ;
$sql[$count][0]="6.0.00" ;
$sql[$count][1]="
ALTER TABLE `gibbonlibraryitem` CHANGE `status` `status` ENUM( 'Available', 'In Use', 'Decommissioned', 'Lost', 'On Loan', 'Repair', 'Reserved' ) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT 'Available' COMMENT 'The current status of the item.' ;end
INSERT INTO `gibbonaction` (`gibbonModuleID` ,`name` ,`precedence` ,`category` ,`description` ,`URLList` ,`entryURL` ,`defaultPermissionAdmin` ,`defaultPermissionTeacher` ,`defaultPermissionStudent` ,`defaultPermissionParent` ,`defaultPermissionSupport` ,`categoryPermissionStaff` ,`categoryPermissionStudent` ,`categoryPermissionParent` ,`categoryPermissionOther`) VALUES ((SELECT gibbonModuleID FROM gibbonmodule WHERE name='Activities'), 'View Activities_studentRegisterByParent', 2, 'Actions', 'Allows parents to register their children for activities', 'activities_view.php, activities_view_full.php, activities_view_register.php', 'activities_view.php', 'N', 'N', 'N', 'Y', 'N', 'N', 'N', 'Y', 'N');end
INSERT INTO `gibbonpermission` (`permissionID` ,`gibbonRoleID` ,`gibbonActionID`) VALUES (NULL , '4', (SELECT gibbonActionID FROM gibbonaction JOIN gibbonmodule ON (gibbonaction.gibbonModuleID=gibbonmodule.gibbonModuleID) WHERE gibbonmodule.name='Activities' AND gibbonaction.name='View Activities_studentRegisterByParent'));end
ALTER TABLE `gibbonoutcome` CHANGE `name` `name` VARCHAR( 100 ) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL ;end
ALTER TABLE `gibbonoutcome` CHANGE `nameShort` `nameShort` VARCHAR( 14 ) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL ;end
ALTER TABLE `gibbonstaff` ADD `firstAidQualified` ENUM( '', 'N', 'Y' ) NOT NULL DEFAULT '' ;end
ALTER TABLE `gibbonstaff` ADD `firstAidExpiry` DATE NULL DEFAULT NULL ;end
UPDATE gibbonaction SET URLList='library_lending.php, library_lending_item.php,library_lending_item_signout.php,library_lending_item_return.php,library_lending_item_edit.php,library_lending_item_renew.php' WHERE name='Lending & Activity Log' AND gibbonModuleID=(SELECT gibbonModuleID FROM gibbonmodule WHERE name='Library');end
UPDATE `gibbonsetting` SET `value`='Citizen,Resident,Student,Other ' WHERE `gibbonsetting`.`gibbonSystemSettingsID`=00061;end
ALTER TABLE `gibbonapplicationform` DROP `nationalIDCardCountry`, DROP `parent1nationalIDCardCountry`, DROP `parent2nationalIDCardCountry` ;end
ALTER TABLE `gibbonapplicationform` ADD `visaExpiryDate` DATE NULL DEFAULT NULL AFTER `residencyStatus` ;end
ALTER TABLE `gibbonapplicationform` ADD `parent1visaExpiryDate` DATE NULL DEFAULT NULL AFTER `parent1residencyStatus` ;end
ALTER TABLE `gibbonapplicationform` ADD `parent2visaExpiryDate` DATE NULL DEFAULT NULL AFTER `parent2residencyStatus` ;end
ALTER TABLE `gibbonperson` DROP `nationalIDCardCountry`;end
ALTER TABLE `gibbonperson` ADD `visaExpiryDate` DATE NULL DEFAULT NULL AFTER `residencyStatus` ;end
ALTER TABLE `gibbonpersonupdate` ADD `visaExpiryDate` DATE NULL DEFAULT NULL AFTER `residencyStatus` ;end
INSERT INTO `gibbonsetting` (`gibbonSystemSettingsID` ,`scope` ,`name` ,`nameDisplay` ,`description` ,`value`)VALUES (NULL , 'Application Form', 'howDidYouHear', 'How Did Your Hear?', 'Comma-separated list of sources where people might have heard about the school from.', 'Advertisement,Personal Recommendation,World Wide Web,Others');end
ALTER TABLE `gibbonapplicationform` ADD `howDidYouHear` VARCHAR( 255 ) NULL DEFAULT NULL ,ADD `howDidYouHearMore` VARCHAR( 255 ) NULL DEFAULT NULL;end
CREATE VIEW moodleUser AS SELECT username, preferredName, surname, email, website FROM gibbonperson WHERE status='Full';end
CREATE VIEW moodleCourse AS SELECT * FROM `gibboncourse` WHERE gibbonSchoolYearID=(SELECT gibbonSchoolYearID FROM gibbonschoolyear Where status='Current');end
CREATE VIEW moodleEnrolment AS SELECT DISTINCT gibboncourse.gibbonCourseID, gibboncourse.name, username, role FROM gibboncourse JOIN gibboncourseclass ON (gibboncourseclass.gibbonCourseID=gibboncourse.gibbonCourseID) JOIN gibboncourseclassperson ON (gibboncourseclassperson.gibbonCourseClassID=gibboncourseclass.gibbonCourseClassID) JOIN gibbonperson ON (gibboncourseclassperson.gibbonPersonID=gibbonperson.gibbonPersonID) WHERE status='Full' AND  gibbonSchoolYearID=(SELECT gibbonSchoolYearID FROM gibbonschoolyear Where status='Current');end
INSERT INTO `gibbonaction` (`gibbonModuleID` ,`name` ,`precedence` ,`category` ,`description` ,`URLList` ,`entryURL` ,`defaultPermissionAdmin` ,`defaultPermissionTeacher` ,`defaultPermissionStudent` ,`defaultPermissionParent` ,`defaultPermissionSupport` ,`categoryPermissionStaff` ,`categoryPermissionStudent` ,`categoryPermissionParent` ,`categoryPermissionOther`) VALUES ((SELECT gibbonModuleID FROM gibbonmodule WHERE name='School Admin'), 'Manage Students Settings', 0, 'People', 'Manage settings for the Student module', 'studentsSettings.php', 'studentsSettings.php', 'Y', 'N', 'N', 'N', 'N', 'Y', 'N', 'N', 'N');end
INSERT INTO `gibbonpermission` (`permissionID` ,`gibbonRoleID` ,`gibbonActionID`) VALUES (NULL , '1', (SELECT gibbonActionID FROM gibbonaction JOIN gibbonmodule ON (gibbonaction.gibbonModuleID=gibbonmodule.gibbonModuleID) WHERE gibbonmodule.name='School Admin' AND gibbonaction.name='Manage Students Settings'));end
INSERT INTO `gibbonsetting` (`gibbonSystemSettingsID` ,`scope` ,`name` ,`nameDisplay` ,`description` ,`value`)VALUES (NULL , 'Students', 'noteCategories', 'Note Categories', 'Comma-separated list of categories to be available for organising notes.', 'Academic,Behaviour,Family,Medical,Pastoral,Other');end
CREATE TABLE `gibbonstudentnote` (  `gibbonStudentNoteID` int(12) unsigned zerofill NOT NULL AUTO_INCREMENT,  `gibbonPersonID` int(10) unsigned zerofill NOT NULL,  `category` varchar(255) NOT NULL,  `note` text NOT NULL,  `gibbonPersonIDCreator` int(10) unsigned zerofill NOT NULL,  `timestamp` timestamp NULL DEFAULT NULL,  PRIMARY KEY (`gibbonStudentNoteID`)) ENGINE=MyISAM  DEFAULT CHARSET=utf8;end
UPDATE gibbonaction SET URLList='student_view.php,student_view_details.php,student_view_details_notes_add.php,student_view_details_notes_edit.php,student_view_details_notes_delete.php' WHERE name='View Student Profile_full' AND gibbonModuleID=(SELECT gibbonModuleID FROM gibbonmodule WHERE name='Students');end
DELETE FROM gibbonaction WHERE gibbonModuleID=(SELECT gibbonModuleID FROM gibbonmodule WHERE name='Message Wall') ;end
DELETE FROM gibbonmodule WHERE name='Message Wall';end
UPDATE gibbonmodule SET name='Messenger', category='Other', description='Unified messenger for email, message wall and more.', entryURL='messenger_manage.php' WHERE name='Mass Mailer';end
UPDATE gibbonaction SET URLList='messenger_post.php', entryURL='messenger_post.php' WHERE gibbonModuleID=(SELECT gibbonModuleID FROM gibbonmodule WHERE name='Messenger') AND URLList='massMailer_post.php' AND entryURL='massMailer_post.php' ;end
UPDATE gibbonaction SET URLList='messenger_manage.php,messenger_manage_delete.php,messenger_manage_edit.php', entryURL='messenger_manage.php' WHERE gibbonModuleID=(SELECT gibbonModuleID FROM gibbonmodule WHERE name='Messenger') AND URLList='massMailer_manage.php,massMailer_manage_delete.php' AND entryURL='massMailer_manage.php' ;end
INSERT INTO `gibbonaction` (`gibbonModuleID` ,`name` ,`precedence` ,`category` ,`description` ,`URLList` ,`entryURL` ,`defaultPermissionAdmin` ,`defaultPermissionTeacher` ,`defaultPermissionStudent` ,`defaultPermissionParent` ,`defaultPermissionSupport` ,`categoryPermissionStaff` ,`categoryPermissionStudent` ,`categoryPermissionParent` ,`categoryPermissionOther`) VALUES ((SELECT gibbonModuleID FROM gibbonmodule WHERE name='Messenger'), 'New Message_byEmail', 0, '', 'Send messages by email.', 'messenger_post.php', 'messenger_post.php', 'Y', 'Y', 'N', 'N', 'N', 'Y', 'Y', 'N', 'N');end
INSERT INTO `gibbonpermission` (`permissionID` ,`gibbonRoleID` ,`gibbonActionID`) VALUES (NULL , '1', (SELECT gibbonActionID FROM gibbonaction JOIN gibbonmodule ON (gibbonaction.gibbonModuleID=gibbonmodule.gibbonModuleID) WHERE gibbonmodule.name='Messenger' AND gibbonaction.name='New Message_byEmail'));end
INSERT INTO `gibbonpermission` (`permissionID` ,`gibbonRoleID` ,`gibbonActionID`) VALUES (NULL , '2', (SELECT gibbonActionID FROM gibbonaction JOIN gibbonmodule ON (gibbonaction.gibbonModuleID=gibbonmodule.gibbonModuleID) WHERE gibbonmodule.name='Messenger' AND gibbonaction.name='New Message_byEmail'));end
INSERT INTO `gibbonaction` (`gibbonModuleID` ,`name` ,`precedence` ,`category` ,`description` ,`URLList` ,`entryURL` ,`defaultPermissionAdmin` ,`defaultPermissionTeacher` ,`defaultPermissionStudent` ,`defaultPermissionParent` ,`defaultPermissionSupport` ,`categoryPermissionStaff` ,`categoryPermissionStudent` ,`categoryPermissionParent` ,`categoryPermissionOther`) VALUES ((SELECT gibbonModuleID FROM gibbonmodule WHERE name='Messenger'), 'New Message_byMessageWall', 0, '', 'Send messages by message wall.', 'messenger_post.php', 'messenger_post.php', 'Y', 'Y', 'N', 'N', 'N', 'Y', 'Y', 'N', 'N');end
INSERT INTO `gibbonpermission` (`permissionID` ,`gibbonRoleID` ,`gibbonActionID`) VALUES (NULL , '1', (SELECT gibbonActionID FROM gibbonaction JOIN gibbonmodule ON (gibbonaction.gibbonModuleID=gibbonmodule.gibbonModuleID) WHERE gibbonmodule.name='Messenger' AND gibbonaction.name='New Message_byMessageWall'));end
INSERT INTO `gibbonpermission` (`permissionID` ,`gibbonRoleID` ,`gibbonActionID`) VALUES (NULL , '2', (SELECT gibbonActionID FROM gibbonaction JOIN gibbonmodule ON (gibbonaction.gibbonModuleID=gibbonmodule.gibbonModuleID) WHERE gibbonmodule.name='Messenger' AND gibbonaction.name='New Message_byMessageWall'));end
INSERT INTO `gibbonaction` (`gibbonModuleID` ,`name` ,`precedence` ,`category` ,`description` ,`URLList` ,`entryURL` ,`defaultPermissionAdmin` ,`defaultPermissionTeacher` ,`defaultPermissionStudent` ,`defaultPermissionParent` ,`defaultPermissionSupport` ,`categoryPermissionStaff` ,`categoryPermissionStudent` ,`categoryPermissionParent` ,`categoryPermissionOther`) VALUES ((SELECT gibbonModuleID FROM gibbonmodule WHERE name='Messenger'), 'New Message_bySMS', 0, '', 'Send messages by SMS.', 'messenger_post.php', 'messenger_post.php', 'Y', 'N', 'N', 'N', 'N', 'Y', 'Y', 'N', 'N');end
INSERT INTO `gibbonpermission` (`permissionID` ,`gibbonRoleID` ,`gibbonActionID`) VALUES (NULL , '1', (SELECT gibbonActionID FROM gibbonaction JOIN gibbonmodule ON (gibbonaction.gibbonModuleID=gibbonmodule.gibbonModuleID) WHERE gibbonmodule.name='Messenger' AND gibbonaction.name='New Message_bySMS'));end
ALTER TABLE `gibbonMassMailerMail` ADD `email` ENUM( 'N', 'Y' ) NOT NULL DEFAULT 'N' AFTER `gibbonMassMailerMailID` ,ADD `messageWall` ENUM( 'N', 'Y' ) NOT NULL DEFAULT 'N' AFTER `email` ,ADD `sms` ENUM( 'N', 'Y' ) NOT NULL DEFAULT 'N' AFTER `messageWall` ;end
UPDATE gibbonMassMailerMail SET email='Y';end
ALTER TABLE `gibbonMassMailerMail` ADD `messageWall_date1` DATE NULL DEFAULT NULL AFTER `messageWall` ,ADD `messageWall_date2` DATE NULL DEFAULT NULL AFTER `messageWall_date1` ,ADD `messageWall_date3` DATE NULL DEFAULT NULL AFTER `messageWall_date2` ;end
DROP TABLE `gibbonMessageWallPost`, `gibbonMessageWallPostTarget`;end
RENAME TABLE `gibbonMassMailerMail` TO `gibbonmessenger`;end
RENAME TABLE `gibbonMassMailerMailTarget` TO `gibbonmessengertarget`;end
ALTER TABLE `gibbonmessenger` CHANGE `gibbonMassMailerMailID` `gibbonMessengerID` INT( 12 ) UNSIGNED ZEROFILL NOT NULL AUTO_INCREMENT ;end
ALTER TABLE `gibbonmessengertarget` CHANGE `gibbonMassMailerMailTargetID` `gibbonMessengerTargetID` INT( 14 ) UNSIGNED ZEROFILL NOT NULL AUTO_INCREMENT ,CHANGE `gibbonMassMailerMailID` `gibbonMessengerID` INT( 12 ) UNSIGNED ZEROFILL NOT NULL ;end
INSERT INTO `gibbonaction` (`gibbonModuleID` ,`name` ,`precedence` ,`category` ,`description` ,`URLList` ,`entryURL` ,`defaultPermissionAdmin` ,`defaultPermissionTeacher` ,`defaultPermissionStudent` ,`defaultPermissionParent` ,`defaultPermissionSupport` ,`categoryPermissionStaff` ,`categoryPermissionStudent` ,`categoryPermissionParent` ,`categoryPermissionOther`) VALUES ((SELECT gibbonModuleID FROM gibbonmodule WHERE name='Messenger'), 'View Message Wall', 0, '', 'Allows users to view all messages posted on their message wall.', 'messageWall_view.php,messageWall_view_full.php', 'messageWall_view.php', 'Y', 'Y', 'N', 'N', 'N', 'Y', 'Y', 'N', 'N');end
INSERT INTO `gibbonpermission` (`permissionID` ,`gibbonRoleID` ,`gibbonActionID`) VALUES (NULL , '1', (SELECT gibbonActionID FROM gibbonaction JOIN gibbonmodule ON (gibbonaction.gibbonModuleID=gibbonmodule.gibbonModuleID) WHERE gibbonmodule.name='Messenger' AND gibbonaction.name='View Message Wall'));end
INSERT INTO `gibbonpermission` (`permissionID` ,`gibbonRoleID` ,`gibbonActionID`) VALUES (NULL , '2', (SELECT gibbonActionID FROM gibbonaction JOIN gibbonmodule ON (gibbonaction.gibbonModuleID=gibbonmodule.gibbonModuleID) WHERE gibbonmodule.name='Messenger' AND gibbonaction.name='View Message Wall'));end
INSERT INTO `gibbonpermission` (`permissionID` ,`gibbonRoleID` ,`gibbonActionID`) VALUES (NULL , '3', (SELECT gibbonActionID FROM gibbonaction JOIN gibbonmodule ON (gibbonaction.gibbonModuleID=gibbonmodule.gibbonModuleID) WHERE gibbonmodule.name='Messenger' AND gibbonaction.name='View Message Wall'));end
INSERT INTO `gibbonpermission` (`permissionID` ,`gibbonRoleID` ,`gibbonActionID`) VALUES (NULL , '4', (SELECT gibbonActionID FROM gibbonaction JOIN gibbonmodule ON (gibbonaction.gibbonModuleID=gibbonmodule.gibbonModuleID) WHERE gibbonmodule.name='Messenger' AND gibbonaction.name='View Message Wall'));end
INSERT INTO `gibbonpermission` (`permissionID` ,`gibbonRoleID` ,`gibbonActionID`) VALUES (NULL , '5', (SELECT gibbonActionID FROM gibbonaction JOIN gibbonmodule ON (gibbonaction.gibbonModuleID=gibbonmodule.gibbonModuleID) WHERE gibbonmodule.name='Messenger' AND gibbonaction.name='View Message Wall'));end
UPDATE gibbonaction SET categoryPermissionParent='Y' WHERE gibbonModuleID=(SELECT gibbonModuleID FROM gibbonmodule WHERE name='Messenger');end
UPDATE gibbonaction SET category='Other' WHERE gibbonModuleID=(SELECT gibbonModuleID FROM gibbonmodule WHERE name='School Admin') AND name='Manage Spaces';end
INSERT INTO `gibbonaction` (`gibbonModuleID` ,`name` ,`precedence` ,`category` ,`description` ,`URLList` ,`entryURL` ,`defaultPermissionAdmin` ,`defaultPermissionTeacher` ,`defaultPermissionStudent` ,`defaultPermissionParent` ,`defaultPermissionSupport` ,`categoryPermissionStaff` ,`categoryPermissionStudent` ,`categoryPermissionParent` ,`categoryPermissionOther`) VALUES ((SELECT gibbonModuleID FROM gibbonmodule WHERE name='School Admin'), 'Manage SMS Settings', 0, 'Other', 'Manage gateway settings for outgoing SMS messages.', 'smsSettings.php', 'smsSettings.php', 'Y', 'N', 'N', 'N', 'N', 'Y', 'N', 'N', 'N');end
INSERT INTO `gibbonpermission` (`permissionID` ,`gibbonRoleID` ,`gibbonActionID`) VALUES (NULL , '1', (SELECT gibbonActionID FROM gibbonaction JOIN gibbonmodule ON (gibbonaction.gibbonModuleID=gibbonmodule.gibbonModuleID) WHERE gibbonmodule.name='School Admin' AND gibbonaction.name='Manage SMS Settings'));end
INSERT INTO `gibbonsetting` (`gibbonSystemSettingsID` ,`scope` ,`name` ,`nameDisplay` ,`description` ,`value`)VALUES (NULL , 'Messenger', 'smsUsername', 'SMS Username', 'SMS gateway username.', '');end
INSERT INTO `gibbonsetting` (`gibbonSystemSettingsID` ,`scope` ,`name` ,`nameDisplay` ,`description` ,`value`)VALUES (NULL , 'Messenger', 'smsPassword', 'SMS Password', 'SMS gateway password.', '');end
INSERT INTO `gibbonsetting` (`gibbonSystemSettingsID` ,`scope` ,`name` ,`nameDisplay` ,`description` ,`value`)VALUES (NULL , 'Messenger', 'smsURL', 'SMS URL', 'SMS gateway URL for send requests.', '');end
INSERT INTO `gibbonsetting` (`gibbonSystemSettingsID` ,`scope` ,`name` ,`nameDisplay` ,`description` ,`value`)VALUES (NULL , 'Messenger', 'smsURLCredit', 'SMS URL Credit', 'SMS gateway URL for checking credit.', '');end
INSERT INTO `gibbonsetting` (`gibbonSystemSettingsID` ,`scope` ,`name` ,`nameDisplay` ,`description` ,`value`)VALUES (NULL , 'System', 'currency', 'Currency', 'System-wde currency for financial transactions.', 'USD $');end
INSERT INTO `gibbonsetting` (`gibbonSystemSettingsID` ,`scope` ,`name` ,`nameDisplay` ,`description` ,`value`)VALUES (NULL , 'System', 'enablePayments', 'Enable Payments', 'Should payments be enabled across the system?', 'N');end
INSERT INTO `gibbonsetting` (`gibbonSystemSettingsID` ,`scope` ,`name` ,`nameDisplay` ,`description` ,`value`)VALUES (NULL , 'System', 'paypalAPIUsername', 'PayPal API Username', 'API Username provided by PayPal.', '');end
INSERT INTO `gibbonsetting` (`gibbonSystemSettingsID` ,`scope` ,`name` ,`nameDisplay` ,`description` ,`value`)VALUES (NULL , 'System', 'paypalAPIPassword', 'PayPal API Password', 'API Password provided by PayPal.', '');end
INSERT INTO `gibbonsetting` (`gibbonSystemSettingsID` ,`scope` ,`name` ,`nameDisplay` ,`description` ,`value`)VALUES (NULL , 'System', 'paypalAPISignature', 'PayPal API Signature', 'API Signature provided by PayPal.', '');end
INSERT INTO `gibbonsetting` (`gibbonSystemSettingsID` ,`scope` ,`name` ,`nameDisplay` ,`description` ,`value`)VALUES (NULL , 'Application Form', 'applicationFee', 'Application Fee', 'The cost of applying to the school.', '0');end
ALTER TABLE `gibbonapplicationform` ADD `paymentMade` ENUM( 'N', 'Y','Exemption' ) NOT NULL DEFAULT 'N',ADD `paypalPaymentToken` VARCHAR( 50 ) NOT NULL ,ADD `paypalPaymentPayerID` VARCHAR( 50 ) NOT NULL ;end
INSERT INTO `gibbonsetting` (`gibbonSystemSettingsID` ,`scope` ,`name` ,`nameDisplay` ,`description` ,`value`)VALUES (NULL , 'Application Form', 'requiredDocuments', 'Required Documents', 'Comma-separated list of documents which must be submitted electronically with the application form.', '');end
CREATE TABLE `gibbonapplicationformfile` ( `gibbonApplicationFormFileID` int(14) unsigned zerofill NOT NULL AUTO_INCREMENT, `gibbonApplicationFormID` int(12) unsigned zerofill NOT NULL, `name` varchar(255) NOT NULL, `path` varchar(255) NOT NULL, PRIMARY KEY (`gibbonApplicationFormFileID`)) ENGINE=MyISAM DEFAULT CHARSET=utf8 ;end
INSERT INTO `gibbonsetting` (`gibbonSystemSettingsID` ,`scope` ,`name` ,`nameDisplay` ,`description` ,`value`)VALUES (NULL , 'Application Form', 'requiredDocumentsCompulsory', 'Required Documents Compulsory?', 'Are the required documents compulsory?', 'N');end
INSERT INTO `gibbonsetting` (`gibbonSystemSettingsID` ,`scope` ,`name` ,`nameDisplay` ,`description` ,`value`)VALUES (NULL , 'Application Form', 'requiredDocumentsText', 'Required Documents Text', 'Explanatory text to appear with the required documents?', '');end
INSERT INTO `gibbonaction` (`gibbonModuleID` ,`name` ,`precedence` ,`category` ,`description` ,`URLList` ,`entryURL` ,`defaultPermissionAdmin` ,`defaultPermissionTeacher` ,`defaultPermissionStudent` ,`defaultPermissionParent` ,`defaultPermissionSupport` ,`categoryPermissionStaff` ,`categoryPermissionStudent` ,`categoryPermissionParent` ,`categoryPermissionOther`) VALUES ((SELECT gibbonModuleID FROM gibbonmodule WHERE name='Library'), 'Catalog Summary', 0, 'Reports', 'Provides an summary overview of items in the catalog.', 'report_catalogSummary.php', 'report_catalogSummary.php', 'Y', 'N', 'N', 'N', 'N', 'Y', 'Y', 'Y', 'N');end
INSERT INTO `gibbonpermission` (`permissionID` ,`gibbonRoleID` ,`gibbonActionID`) VALUES (NULL , '1', (SELECT gibbonActionID FROM gibbonaction JOIN gibbonmodule ON (gibbonaction.gibbonModuleID=gibbonmodule.gibbonModuleID) WHERE gibbonmodule.name='Library' AND gibbonaction.name='Catalog Summary'));end
DROP VIEW moodleUser;end
CREATE VIEW moodleUser AS SELECT username, preferredName, surname, email, website FROM gibbonperson JOIN gibbonrole ON (gibbonrole.gibbonRoleID=gibbonperson.gibbonRoleIDPrimary) WHERE (category='Student' OR category='Staff') AND status='Full';end
CREATE TABLE `gibbonfamilyrelationship` (  `gibbonFamilyRelationshipID` int(9) unsigned zerofill NOT NULL AUTO_INCREMENT,  `gibbonFamilyID` int(7) unsigned zerofill NOT NULL,  `gibbonPersonID1` int(10) unsigned zerofill NOT NULL,  `gibbonPersonID2` int(10) unsigned zerofill NOT NULL,  `relationship` varchar(50) NOT NULL,  PRIMARY KEY (`gibbonFamilyRelationshipID`)) ENGINE=MyISAM DEFAULT CHARSET=utf8 COMMENT='Person 1 is [relationship] to person 2?' ;end
ALTER TABLE gibbonfamilychild DROP COLUMN role;end 
ALTER TABLE gibbonfamilyadult DROP COLUMN role;end 
ALTER TABLE `gibbonapplicationform` ADD `parent1relationship` VARCHAR( 50 ) NOT NULL AFTER `parent1gender` ;end
ALTER TABLE `gibbonapplicationform` ADD `parent2relationship` VARCHAR( 50 ) NOT NULL AFTER `parent2gender` ;end
CREATE TABLE `gibbonapplicationformrelationship` (  `gibbonApplicationFormRelationshipID` int(14) unsigned zerofill NOT NULL AUTO_INCREMENT,  `gibbonApplicationFormID` int(12) unsigned zerofill NOT NULL,  `gibbonPersonID` int(10) unsigned zerofill NOT NULL,  `relationship` varchar(50) NOT NULL,  PRIMARY KEY (`gibbonApplicationFormRelationshipID`)) ENGINE=MyISAM DEFAULT CHARSET=utf8 AUTO_INCREMENT=1 ;end
ALTER TABLE `gibbonpersonupdate` ADD `vehicleRegistration` VARCHAR( 20 ) NOT NULL AFTER `emergency2Relationship` ;end
ALTER TABLE gibbonunit DROP COLUMN type;end
ALTER TABLE gibbonunitclass DROP COLUMN dateFirstLesson;end 
ALTER TABLE `gibbonperson` ADD `lastFailIPAddress` VARCHAR( 15 ) NULL DEFAULT NULL AFTER `lastTimestamp` ,ADD `lastFailTimestamp` TIMESTAMP NULL DEFAULT NULL AFTER `lastFailIPAddress` ,ADD `failCount` INT( 1 ) NULL DEFAULT '0' AFTER `lastFailTimestamp` ;end
INSERT INTO `gibbonsetting` (`gibbonSystemSettingsID` ,`scope` ,`name` ,`nameDisplay` ,`description` ,`value`)VALUES (NULL , 'Application Form', 'notificationDefault', 'Notification Default', 'Should acceptance email be turned on or off by default.', 'On');end
INSERT INTO `gibbonaction` (`gibbonModuleID` ,`name` ,`precedence` ,`category` ,`description` ,`URLList` ,`entryURL` ,`defaultPermissionAdmin` ,`defaultPermissionTeacher` ,`defaultPermissionStudent` ,`defaultPermissionParent` ,`defaultPermissionSupport` ,`categoryPermissionStaff` ,`categoryPermissionStudent` ,`categoryPermissionParent` ,`categoryPermissionOther`) VALUES ((SELECT gibbonModuleID FROM gibbonmodule WHERE name='Students'), 'New Students', 1, 'Reports', 'A report showing all new students in the current school year.', 'report_students_new.php', 'report_students_new.php', 'Y', 'N', 'N', 'N', 'N', 'Y', 'N', 'N', 'N');end
INSERT INTO `gibbonpermission` (`permissionID` ,`gibbonRoleID` ,`gibbonActionID`) VALUES (NULL , '1', (SELECT gibbonActionID FROM gibbonaction JOIN gibbonmodule ON (gibbonaction.gibbonModuleID=gibbonmodule.gibbonModuleID) WHERE gibbonmodule.name='Students' AND gibbonaction.name='New Students'));end
INSERT INTO `gibbonaction` (`gibbonModuleID` ,`name` ,`precedence` ,`category` ,`description` ,`URLList` ,`entryURL` ,`defaultPermissionAdmin` ,`defaultPermissionTeacher` ,`defaultPermissionStudent` ,`defaultPermissionParent` ,`defaultPermissionSupport` ,`categoryPermissionStaff` ,`categoryPermissionStudent` ,`categoryPermissionParent` ,`categoryPermissionOther`) VALUES ((SELECT gibbonModuleID FROM gibbonmodule WHERE name='Students'), 'Left Students', 1, 'Reports', 'A report showing all the students who have left within a specified date range.', 'report_students_left.php', 'report_students_left.php', 'Y', 'N', 'N', 'N', 'N', 'Y', 'N', 'N', 'N');end
INSERT INTO `gibbonpermission` (`permissionID` ,`gibbonRoleID` ,`gibbonActionID`) VALUES (NULL , '1', (SELECT gibbonActionID FROM gibbonaction JOIN gibbonmodule ON (gibbonaction.gibbonModuleID=gibbonmodule.gibbonModuleID) WHERE gibbonmodule.name='Students' AND gibbonaction.name='Left Students'));end
INSERT INTO `gibbonsetting` (`gibbonSystemSettingsID`, `scope`, `name`, `nameDisplay`, `description`, `value`) VALUES (NULL, 'Application Form', 'languageOptionsActive', 'Language Options Active', 'Should the Language Options section be turned on?', 'Off'), (NULL, 'Application Form', 'languageOptionsBlurb', 'Language Options Blurb', 'Introductory text if Language Options section is turned on.', ''), (NULL, 'Application Form', 'languageOptionsLanguageList', 'Language Options Language List', 'Comma-separated list of available language selections if Language Options section is turned on.', '');end
ALTER TABLE `gibbonapplicationform` ADD `languageChoice` VARCHAR( 100 ) NULL AFTER `developmentInformation` ,ADD `languageChoiceExperience` TEXT NULL AFTER `languageChoice` ;end
INSERT INTO `gibbonsetting` (`gibbonSystemSettingsID`, `scope`, `name`, `nameDisplay`, `description`, `value`) VALUES (NULL, 'Markbook', 'wordpressCommentPush', 'Wordpress Comment Push', 'Where student work is submitted via a WordPress website, the teacher can choose to push their Markbook comment to the site.', 'Off');end
DROP VIEW moodleUser;end
DROP VIEW moodleCourse;end
DROP VIEW moodleEnrolment;end
UPDATE `gibbonaction` SET `URLList`='courseEnrolment_manage_byPerson.php, courseEnrolment_manage_byPerson_edit.php, courseEnrolment_manage_byPerson_edit_edit.php, courseEnrolment_manage_byPerson_edit_delete.php' WHERE `gibbonaction`.`name`='Course Enrolment by Person' AND gibbonModuleID=(SELECT gibbonModuleID FROM gibbonmodule WHERE gibbonmodule.name='Timetable Admin');end
INSERT INTO `gibbonaction` (`gibbonModuleID` ,`name` ,`precedence` ,`category` ,`description` ,`URLList` ,`entryURL` ,`defaultPermissionAdmin` ,`defaultPermissionTeacher` ,`defaultPermissionStudent` ,`defaultPermissionParent` ,`defaultPermissionSupport` ,`categoryPermissionStaff` ,`categoryPermissionStudent` ,`categoryPermissionParent` ,`categoryPermissionOther`) VALUES ((SELECT gibbonModuleID FROM gibbonmodule WHERE name='School Admin'), 'Manage File Extensions', 0, 'Other', 'Manage file extensions allowed across the system', 'fileExtensions_manage.php,fileExtensions_manage_add.php,fileExtensions_manage_edit.php,fileExtensions_manage_delete.php', 'fileExtensions_manage.php', 'Y', 'N', 'N', 'N', 'N', 'Y', 'N', 'N', 'N');end
INSERT INTO `gibbonpermission` (`permissionID` ,`gibbonRoleID` ,`gibbonActionID`) VALUES (NULL , '1', (SELECT gibbonActionID FROM gibbonaction JOIN gibbonmodule ON (gibbonaction.gibbonModuleID=gibbonmodule.gibbonModuleID) WHERE gibbonmodule.name='School Admin' AND gibbonaction.name='Manage File Extensions'));end
INSERT INTO `gibbonsetting` (`gibbonSystemSettingsID`, `scope`, `name`, `nameDisplay`, `description`, `value`) VALUES (NULL, 'User Admin', 'personalBackground', 'Personal Background', 'Should users be allowed to set their own personal backgrounds?', 'Y');end
ALTER TABLE `gibbonperson` ADD `personalBackground` VARCHAR( 255 ) NOT NULL ;end
INSERT INTO `gibbonsetting` (`gibbonSystemSettingsID` ,`scope` ,`name` ,`nameDisplay` ,`description` ,`value`)VALUES (NULL , 'Application Form', 'dayTypeOptions', 'Day-Type Options', 'Comma-separated list of options to make available (e.g. half-day, full-day). If blank, this field will not show up in the application form. ', ''), (NULL , 'Application Form', 'dayTypeText', 'Day-Type Text', 'Explanatory text to include with Day-Type Otpions.', '');end
ALTER TABLE `gibbonapplicationform` ADD `dayType` VARCHAR( 255 ) NULL AFTER `gibbonYearGroupIDEntry` ;end
ALTER TABLE `gibbonperson` ADD `messengerLastBubble` DATE NULL DEFAULT NULL ;end
CREATE TABLE `gibbonplannerentryoutcome` (  `gibbonPlannerEntryOutcomeID` int(16) unsigned zerofill NOT NULL AUTO_INCREMENT,  `gibbonPlannerEntryID` int(14) unsigned zerofill NOT NULL,  `gibbonOutcomeID` int(8) unsigned zerofill NOT NULL,  `sequenceNumber` int(4) NOT NULL,  `content` text NOT NULL,  PRIMARY KEY (`gibbonPlannerEntryOutcomeID`)) ENGINE=MyISAM DEFAULT CHARSET=utf8 ;end
ALTER TABLE `gibbonactivity` CHANGE `payment` `payment` DECIMAL( 8, 2 ) NOT NULL ;end
INSERT INTO `gibbonaction` (`gibbonModuleID` ,`name` ,`precedence` ,`category` ,`description` ,`URLList` ,`entryURL` ,`defaultPermissionAdmin` ,`defaultPermissionTeacher` ,`defaultPermissionStudent` ,`defaultPermissionParent` ,`defaultPermissionSupport` ,`categoryPermissionStaff` ,`categoryPermissionStudent` ,`categoryPermissionParent` ,`categoryPermissionOther`) VALUES ((SELECT gibbonModuleID FROM gibbonmodule WHERE name='Students'), 'Student ID Cards ', 1, 'Reports', 'A report for bulk creation of student ID cards.', 'report_students_IDCards.php', 'report_students_IDCards.php', 'Y', 'N', 'N', 'N', 'N', 'Y', 'N', 'N', 'N');end
INSERT INTO `gibbonpermission` (`permissionID` ,`gibbonRoleID` ,`gibbonActionID`) VALUES (NULL , '1', (SELECT gibbonActionID FROM gibbonaction JOIN gibbonmodule ON (gibbonaction.gibbonModuleID=gibbonmodule.gibbonModuleID) WHERE gibbonmodule.name='Students' AND gibbonaction.name='Student ID Cards'));end
UPDATE `gibbonaction` SET `name`='Edit Markbook_singleClass', description='Edit columns and grades for a single class at a time.' WHERE `gibbonaction`.`name`='Edit Markbook' AND gibbonModuleID=(SELECT gibbonModuleID FROM gibbonmodule WHERE gibbonmodule.name='Markbook');end
INSERT INTO `gibbonaction` (`gibbonModuleID` ,`name` ,`precedence` ,`category` ,`description` ,`URLList` ,`entryURL` ,`defaultPermissionAdmin` ,`defaultPermissionTeacher` ,`defaultPermissionStudent` ,`defaultPermissionParent` ,`defaultPermissionSupport` ,`categoryPermissionStaff` ,`categoryPermissionStudent` ,`categoryPermissionParent` ,`categoryPermissionOther`) VALUES ((SELECT gibbonModuleID FROM gibbonmodule WHERE name='Markbook'), 'Edit Markbook_multipleClassesInDepartment', 1, '', 'Edit columns and grades for a single class belonging to the user, or multiple classes within departments.', 'markbook_edit.php, markbook_edit_add.php,markbook_edit_addMulti.php,markbook_edit_edit.php, markbook_edit_delete.php,markbook_edit_data.php', 'markbook_edit.php', 'N', 'Y', 'N', 'N', 'N', 'Y', 'N', 'N', 'N');end
INSERT INTO `gibbonpermission` (`permissionID` ,`gibbonRoleID` ,`gibbonActionID`) VALUES (NULL , '2', (SELECT gibbonActionID FROM gibbonaction JOIN gibbonmodule ON (gibbonaction.gibbonModuleID=gibbonmodule.gibbonModuleID) WHERE gibbonmodule.name='Markbook' AND gibbonaction.name='Edit Markbook_multipleClassesInDepartment'));end
INSERT INTO `gibbonaction` (`gibbonModuleID` ,`name` ,`precedence` ,`category` ,`description` ,`URLList` ,`entryURL` ,`defaultPermissionAdmin` ,`defaultPermissionTeacher` ,`defaultPermissionStudent` ,`defaultPermissionParent` ,`defaultPermissionSupport` ,`categoryPermissionStaff` ,`categoryPermissionStudent` ,`categoryPermissionParent` ,`categoryPermissionOther`) VALUES ((SELECT gibbonModuleID FROM gibbonmodule WHERE name='Markbook'), 'Edit Markbook_multipleClassesAcrossSchool', 2, '', 'Edit columns and grades for a single class belonging to the user, or multiple classes across the whole school.', 'markbook_edit.php, markbook_edit_add.php,markbook_edit_addMulti.php, markbook_edit_edit.php, markbook_edit_delete.php,markbook_edit_data.php', 'markbook_edit.php', 'Y', 'N', 'N', 'N', 'N', 'Y', 'N', 'N', 'N');end
INSERT INTO `gibbonpermission` (`permissionID` ,`gibbonRoleID` ,`gibbonActionID`) VALUES (NULL , '1', (SELECT gibbonActionID FROM gibbonaction JOIN gibbonmodule ON (gibbonaction.gibbonModuleID=gibbonmodule.gibbonModuleID) WHERE gibbonmodule.name='Markbook' AND gibbonaction.name='Edit Markbook_multipleClassesAcrossSchool'));end
ALTER TABLE `gibbonmarkbookcolumn` ADD `groupingID` INT( 8 ) UNSIGNED ZEROFILL NULL DEFAULT NULL COMMENT 'A value used to group multiple markbook columns.' AFTER `gibbonPlannerEntryID` ;end
INSERT INTO `gibbonsetting` (`gibbonSystemSettingsID`, `scope`, `name`, `nameDisplay`, `description`, `value`) VALUES (NULL, 'Markbook', 'showStudentAttainmentWarning', 'Show Student Attainment Warning', 'Show low attainment grade visual warning to students?', 'Y');end
INSERT INTO `gibbonsetting` (`gibbonSystemSettingsID`, `scope`, `name`, `nameDisplay`, `description`, `value`) VALUES (NULL, 'Markbook', 'showStudentEffortWarning', 'Show Student Effort Warning', 'Show low effort grade visual warning to students?', 'Y');end
INSERT INTO `gibbonsetting` (`gibbonSystemSettingsID`, `scope`, `name`, `nameDisplay`, `description`, `value`) VALUES (NULL, 'Markbook', 'showParentAttainmentWarning', 'Show Parent Attainment Warning', 'Show low attainment grade visual warning to parents?', 'Y');end
INSERT INTO `gibbonsetting` (`gibbonSystemSettingsID`, `scope`, `name`, `nameDisplay`, `description`, `value`) VALUES (NULL, 'Markbook', 'showParentEffortWarning', 'Show Parent Effort Warning', 'Show low effort grade visual warning to parents?', 'Y');end
INSERT INTO `gibbonsetting` (`gibbonSystemSettingsID`, `scope`, `name`, `nameDisplay`, `description`, `value`) VALUES (NULL, 'Planner', 'allowOutcomeEditing', 'Allow Outcome Editing', 'Should the text within outcomes be editable when planning lessons and units?', 'Y');end
INSERT INTO `gibbonaction` (`gibbonModuleID` ,`name` ,`precedence` ,`category` ,`description` ,`URLList` ,`entryURL` ,`defaultPermissionAdmin` ,`defaultPermissionTeacher` ,`defaultPermissionStudent` ,`defaultPermissionParent` ,`defaultPermissionSupport` ,`categoryPermissionStaff` ,`categoryPermissionStudent` ,`categoryPermissionParent` ,`categoryPermissionOther`) VALUES ((SELECT gibbonModuleID FROM gibbonmodule WHERE name='Timetable'), 'View Available Spaces', 0, 'Reports', 'View unassigned rooms by timetable.', 'report_viewAvailableSpaces.php', 'report_viewAvailableSpaces.php', 'Y', 'N', 'N', 'N', 'N', 'Y', 'Y', 'Y', 'Y');end
INSERT INTO `gibbonpermission` (`permissionID` ,`gibbonRoleID` ,`gibbonActionID`) VALUES (NULL , '1', (SELECT gibbonActionID FROM gibbonaction JOIN gibbonmodule ON (gibbonaction.gibbonModuleID=gibbonmodule.gibbonModuleID) WHERE gibbonmodule.name='Timetable' AND gibbonaction.name='View Available Spaces'));end
UPDATE `gibbonaction` SET `category`='View Timetables' WHERE `gibbonaction`.`name`='View Timetable by Person' AND gibbonModuleID=(SELECT gibbonModuleID FROM gibbonmodule WHERE gibbonmodule.name='Timetable');end
UPDATE `gibbonaction` SET `category`='View Timetables' WHERE `gibbonaction`.`name`='View Timetable by Space' AND gibbonModuleID=(SELECT gibbonModuleID FROM gibbonmodule WHERE gibbonmodule.name='Timetable');end
";

//v7.0.00
$count++ ;
$sql[$count][0]="7.0.00" ;
$sql[$count][1]="
ALTER TABLE `gibbonapplicationform` DROP `parent1contactCall` ,DROP `parent1contactSMS` ,DROP `parent1contactEmail` ,DROP `parent1contactMail` ,DROP `parent2contactCall` ,DROP `parent2contactSMS` ,DROP `parent2contactEmail` ,DROP `parent2contactMail` ;end
INSERT INTO `gibbonsetting` (`gibbonSystemSettingsID`, `scope`, `name`, `nameDisplay`, `description`, `value`) VALUES (NULL, 'User Admin', 'imagePrivacy', 'Image Privacy', 'Should image privacy options be turned on across the system?', 'N');end
INSERT INTO `gibbonsetting` (`gibbonSystemSettingsID`, `scope`, `name`, `nameDisplay`, `description`, `value`) VALUES (NULL, 'User Admin', 'imagePrivacyBlurb', 'Image Privacy Blurb', 'Descriptive text to accompany image privacy option when shown to users.', '');end
ALTER TABLE `gibbonperson` ADD `imagePrivacy` ENUM( '','N', 'Y' ) NOT NULL DEFAULT '' ;end
ALTER TABLE `gibbonapplicationform` ADD `imagePrivacy` ENUM( '','N', 'Y' ) NOT NULL DEFAULT '' ;end
ALTER TABLE `gibbonpersonupdate` ADD `imagePrivacy` ENUM( '','N', 'Y' ) NOT NULL DEFAULT '' ;end
ALTER TABLE `gibbonfamily` ADD `homeAddress` MEDIUMTEXT NOT NULL AFTER `nameAddress` ,ADD `homeAddressDistrict` VARCHAR( 255 ) NOT NULL AFTER `homeAddress` ,ADD `homeAddressCountry` VARCHAR( 255 ) NOT NULL AFTER `homeAddressDistrict` ;end
UPDATE gibbonfamily JOIN gibbonfamilyadult ON (gibbonfamilyadult.gibbonFamilyID=gibbonfamily.gibbonFamilyID) JOIN gibbonperson ON (gibbonfamilyadult.gibbonPersonID=gibbonperson.gibbonPersonID) SET gibbonfamily.homeAddress=gibbonperson.address1, gibbonfamily.homeAddressDistrict=gibbonperson.address1District, gibbonfamily.homeAddressCountry=gibbonperson.address1Country WHERE contactPriority=1 ;end
UPDATE gibbonfamily JOIN gibbonfamilyadult ON (gibbonfamilyadult.gibbonFamilyID=gibbonfamily.gibbonFamilyID) JOIN gibbonperson ON (gibbonfamilyadult.gibbonPersonID=gibbonperson.gibbonPersonID) SET gibbonperson.address1='', gibbonperson.address1District='', gibbonperson.address1Country='' WHERE gibbonfamily.homeAddress=gibbonperson.address1 AND gibbonfamily.homeAddressDistrict=gibbonperson.address1District AND gibbonfamily.homeAddressCountry=gibbonperson.address1Country;end
UPDATE gibbonfamily JOIN gibbonfamilychild ON (gibbonfamilychild.gibbonFamilyID=gibbonfamily.gibbonFamilyID) JOIN gibbonperson ON (gibbonfamilychild.gibbonPersonID=gibbonperson.gibbonPersonID) SET gibbonperson.address1='', gibbonperson.address1District='', gibbonperson.address1Country='' WHERE gibbonfamily.homeAddress=gibbonperson.address1 AND gibbonfamily.homeAddressDistrict=gibbonperson.address1District AND gibbonfamily.homeAddressCountry=gibbonperson.address1Country;end
ALTER TABLE `gibbonapplicationform` CHANGE `address1` `homeAddress` MEDIUMTEXT CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL , CHANGE `address1District` `homeAddressDistrict` VARCHAR( 255 ) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL ,CHANGE `address1Country` `homeAddressCountry` VARCHAR( 255 ) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL ;end
ALTER TABLE `gibbonapplicationform` DROP `parent1address1` ,DROP `parent1address1District` ,DROP `parent1address1Country` ,DROP `parent2address1` ,DROP `parent2address1District` ,DROP `parent2address1Country` ;end
INSERT INTO `gibbonaction` (`gibbonModuleID` ,`name` ,`precedence` ,`category` ,`description` ,`URLList` ,`entryURL` ,`defaultPermissionAdmin` ,`defaultPermissionTeacher` ,`defaultPermissionStudent` ,`defaultPermissionParent` ,`defaultPermissionSupport` ,`categoryPermissionStaff` ,`categoryPermissionStudent` ,`categoryPermissionParent` ,`categoryPermissionOther`) VALUES ((SELECT gibbonModuleID FROM gibbonmodule WHERE name='Data Updater'), 'Update Family Data_any', 1, '', 'Create family data update request for any user', 'data_family.php', 'data_family.php', 'Y', 'N', 'N', 'N', 'N', 'Y', 'N', 'N', 'N');end
INSERT INTO `gibbonpermission` (`permissionID` ,`gibbonRoleID` ,`gibbonActionID`) VALUES (NULL , '1', (SELECT gibbonActionID FROM gibbonaction JOIN gibbonmodule ON (gibbonaction.gibbonModuleID=gibbonmodule.gibbonModuleID) WHERE gibbonmodule.name='Data Updater' AND gibbonaction.name='Update Family Data_any'));end
INSERT INTO `gibbonaction` (`gibbonModuleID` ,`name` ,`precedence` ,`category` ,`description` ,`URLList` ,`entryURL` ,`defaultPermissionAdmin` ,`defaultPermissionTeacher` ,`defaultPermissionStudent` ,`defaultPermissionParent` ,`defaultPermissionSupport` ,`categoryPermissionStaff` ,`categoryPermissionStudent` ,`categoryPermissionParent` ,`categoryPermissionOther`) VALUES ((SELECT gibbonModuleID FROM gibbonmodule WHERE name='Data Updater'), 'Update Family Data_family', 0, '', 'Allows adults in a family to create data update request for their family.', 'data_family.php', 'data_family.php', 'Y', 'Y', 'N', 'Y', 'Y', 'Y', 'N', 'Y', 'N');end
INSERT INTO `gibbonpermission` (`permissionID` ,`gibbonRoleID` ,`gibbonActionID`) VALUES (NULL , '1', (SELECT gibbonActionID FROM gibbonaction JOIN gibbonmodule ON (gibbonaction.gibbonModuleID=gibbonmodule.gibbonModuleID) WHERE gibbonmodule.name='Data Updater' AND gibbonaction.name='Update Family Data_family'));end
INSERT INTO `gibbonpermission` (`permissionID` ,`gibbonRoleID` ,`gibbonActionID`) VALUES (NULL , '2', (SELECT gibbonActionID FROM gibbonaction JOIN gibbonmodule ON (gibbonaction.gibbonModuleID=gibbonmodule.gibbonModuleID) WHERE gibbonmodule.name='Data Updater' AND gibbonaction.name='Update Family Data_family'));end
INSERT INTO `gibbonpermission` (`permissionID` ,`gibbonRoleID` ,`gibbonActionID`) VALUES (NULL , '4', (SELECT gibbonActionID FROM gibbonaction JOIN gibbonmodule ON (gibbonaction.gibbonModuleID=gibbonmodule.gibbonModuleID) WHERE gibbonmodule.name='Data Updater' AND gibbonaction.name='Update Family Data_family'));end
INSERT INTO `gibbonpermission` (`permissionID` ,`gibbonRoleID` ,`gibbonActionID`) VALUES (NULL , '6', (SELECT gibbonActionID FROM gibbonaction JOIN gibbonmodule ON (gibbonaction.gibbonModuleID=gibbonmodule.gibbonModuleID) WHERE gibbonmodule.name='Data Updater' AND gibbonaction.name='Update Family Data_family'));end
CREATE TABLE `gibbonfamilyupdate` (  `gibbonFamilyUpdateID` int(9) unsigned zerofill NOT NULL AUTO_INCREMENT,  `status` enum('Pending','Complete') NOT NULL DEFAULT 'Pending',  `gibbonFamilyID` int(7) unsigned zerofill NOT NULL,  `nameAddress` varchar(100) NOT NULL DEFAULT '',  `homeAddress` mediumtext NOT NULL DEFAULT '',  `homeAddressDistrict` varchar(255) NOT NULL DEFAULT '',  `homeAddressCountry` varchar(255) NOT NULL DEFAULT '',  `gibbonPersonIDUpdater` int(10) unsigned zerofill NOT NULL,  `timestamp` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,  PRIMARY KEY (`gibbonFamilyUpdateID`)) ENGINE=MyISAM  DEFAULT CHARSET=utf8 ;end
INSERT INTO `gibbonaction` (`gibbonModuleID` ,`name` ,`precedence` ,`category` ,`description` ,`URLList` ,`entryURL` ,`defaultPermissionAdmin` ,`defaultPermissionTeacher` ,`defaultPermissionStudent` ,`defaultPermissionParent` ,`defaultPermissionSupport` ,`categoryPermissionStaff` ,`categoryPermissionStudent` ,`categoryPermissionParent` ,`categoryPermissionOther`) VALUES ((SELECT gibbonModuleID FROM gibbonmodule WHERE name='User Admin'), 'Family Data Updates', 0, 'Data Updater', 'Manage requests for updates to family data.', 'data_family.php,data_family_edit.php,data_family_delete.php', 'data_family.php', 'Y', 'N', 'N', 'N', 'N', 'Y', 'N', 'N', 'N');end
INSERT INTO `gibbonpermission` (`permissionID` ,`gibbonRoleID` ,`gibbonActionID`) VALUES (NULL , '1', (SELECT gibbonActionID FROM gibbonaction JOIN gibbonmodule ON (gibbonaction.gibbonModuleID=gibbonmodule.gibbonModuleID) WHERE gibbonmodule.name='User Admin' AND gibbonaction.name='Family Data Updates'));end
ALTER TABLE `gibbonmessenger` ADD `emailReport` TEXT NOT NULL ,ADD `smsReport` TEXT NOT NULL ;end
INSERT INTO `gibbonmodule` (`gibbonModuleID` ,`name` ,`description` ,`entryURL` ,`type` ,`active` ,`category` ,`version` ,`author` ,`url`)VALUES (NULL, 'Finance', 'Allows a school to issue invocies and track payments.', 'invoices_manage.php', 'Core', 'Y', 'Other', '', 'Ross Parker', 'http://rossparker.org') ;end
INSERT INTO `gibbonaction` (`gibbonModuleID`, `name`, `precedence`, `category`, `description`, `URLList`, `entryURL`, `defaultPermissionAdmin`, `defaultPermissionTeacher`, `defaultPermissionStudent`, `defaultPermissionParent`, `defaultPermissionSupport`, `categoryPermissionStaff`, `categoryPermissionStudent`, `categoryPermissionParent`, `categoryPermissionOther`) VALUES ((SELECT gibbonModuleID FROM gibbonmodule WHERE name='Finance'), 'Manage Fee Categories', 0, 'Admin', 'Allows users to create, edit and delete fee categories.', 'feeCategories_manage.php,feeCategories_manage_add.php,feeCategories_manage_edit.php,feeCategories_manage_delete.php', 'feeCategories_manage.php', 'Y', 'N', 'N', 'N', 'N', 'Y', 'N', 'N', 'N') ;end
INSERT INTO `gibbonpermission` (`permissionID` ,`gibbonRoleID` ,`gibbonActionID`) VALUES (NULL , '1', (SELECT gibbonActionID FROM gibbonaction JOIN gibbonmodule ON (gibbonaction.gibbonModuleID=gibbonmodule.gibbonModuleID) WHERE gibbonmodule.name='Finance' AND gibbonaction.name='Manage Fee Categories'));end
CREATE TABLE `gibbonfinancefeecategory` (  `gibbonFinanceFeeCategoryID` int(4) unsigned zerofill NOT NULL AUTO_INCREMENT,  `name` varchar(100) NOT NULL,  `nameShort` varchar(6) NOT NULL,  `description` text NOT NULL,  `active` enum('Y','N') NOT NULL,  `gibbonPersonIDCreator` int(10) unsigned zerofill NOT NULL,  `timestampCreator` timestamp NULL DEFAULT NULL,  `gibbonPersonIDUpdate` int(10) unsigned zerofill NULL DEFAULT NULL,  `timestampUpdate` timestamp NULL DEFAULT NULL,  PRIMARY KEY (`gibbonFinanceFeeCategoryID`)) ENGINE=MyISAM DEFAULT CHARSET=utf8;end
INSERT INTO `gibbonfinancefeecategory` (`gibbonFinanceFeeCategoryID`, `name`, `nameShort`, `description`, `active`, `gibbonPersonIDCreator`, `timestampCreator`, `gibbonPersonIDUpdate`, `timestampUpdate`) VALUES (0001, 'Other', 'OTHR', 'Category for fees not fitting into any other category.', 'Y', 00000001, '2013-07-12 08:25:32', NULL, NULL);end
RENAME TABLE `gibbonPersonPayment` TO `gibbonfinanceinvoicee` ;end
ALTER TABLE `gibbonfinanceinvoicee` CHANGE `gibbonPersonPaymentID` `gibbonFinanceInvoiceeID` INT( 10 ) UNSIGNED ZEROFILL NOT NULL AUTO_INCREMENT ;end
ALTER TABLE `gibbonfinanceinvoicee` ADD `companyAll` ENUM( 'Y', 'N' ) NULL DEFAULT NULL COMMENT 'Should company pay all invoices?.';end
ALTER TABLE `gibbonfinanceinvoicee` ADD `gibbonFinanceFeeCategoryIDList` TEXT NULL DEFAULT NULL COMMENT 'If companyAll is N, list category IDs for campany to pay here.';end
UPDATE gibbonfinanceinvoicee SET companyAll='Y' WHERE invoiceTo='Company';end
ALTER TABLE `gibbonapplicationform` ADD `companyAll` ENUM( 'Y', 'N' ) NULL DEFAULT NULL AFTER `companyPhone` ,ADD `gibbonFinanceFeeCategoryIDList` TEXT NULL DEFAULT NULL AFTER `companyAll` ;end
INSERT INTO `gibbonaction` (`gibbonModuleID`, `name`, `precedence`, `category`, `description`, `URLList`, `entryURL`, `defaultPermissionAdmin`, `defaultPermissionTeacher`, `defaultPermissionStudent`, `defaultPermissionParent`, `defaultPermissionSupport`, `categoryPermissionStaff`, `categoryPermissionStudent`, `categoryPermissionParent`, `categoryPermissionOther`) VALUES ((SELECT gibbonModuleID FROM gibbonmodule WHERE name='Finance'), 'Manage Invoicees', 0, 'Admin', 'Allows users to view and edit invoice recipients.', 'invoicees_manage.php,invoicees_manage_edit.php', 'invoicees_manage.php', 'Y', 'N', 'N', 'N', 'N', 'Y', 'N', 'N', 'N') ;end
INSERT INTO `gibbonpermission` (`permissionID` ,`gibbonRoleID` ,`gibbonActionID`) VALUES (NULL , '1', (SELECT gibbonActionID FROM gibbonaction JOIN gibbonmodule ON (gibbonaction.gibbonModuleID=gibbonmodule.gibbonModuleID) WHERE gibbonmodule.name='Finance' AND gibbonaction.name='Manage Invoicees'));end
INSERT INTO `gibbonaction` (`gibbonModuleID`, `name`, `precedence`, `category`, `description`, `URLList`, `entryURL`, `defaultPermissionAdmin`, `defaultPermissionTeacher`, `defaultPermissionStudent`, `defaultPermissionParent`, `defaultPermissionSupport`, `categoryPermissionStaff`, `categoryPermissionStudent`, `categoryPermissionParent`, `categoryPermissionOther`) VALUES ((SELECT gibbonModuleID FROM gibbonmodule WHERE name='Finance'), 'Manage Fees', 0, 'Admin', 'Allows users to create, view and edit fees.', 'fees_manage.php,fees_manage_edit.php,fees_manage_add.php', 'fees_manage.php', 'Y', 'N', 'N', 'N', 'N', 'Y', 'N', 'N', 'N') ;end
INSERT INTO `gibbonpermission` (`permissionID` ,`gibbonRoleID` ,`gibbonActionID`) VALUES (NULL , '1', (SELECT gibbonActionID FROM gibbonaction JOIN gibbonmodule ON (gibbonaction.gibbonModuleID=gibbonmodule.gibbonModuleID) WHERE gibbonmodule.name='Finance' AND gibbonaction.name='Manage Fees'));end
CREATE TABLE `gibbonfinancefee` (  `gibbonFinanceFeeID` int(6) unsigned zerofill NOT NULL AUTO_INCREMENT,  `gibbonSchoolYearID` int(3) unsigned zerofill NOT NULL,  `name` varchar(100) NOT NULL,  `nameShort` varchar(6) NOT NULL,  `description` text NOT NULL,  `active` enum('Y','N') NOT NULL DEFAULT 'Y',  `gibbonFinanceFeeCategoryID` int(4) unsigned zerofill NOT NULL,  `fee` decimal(12,2) NOT NULL,  `gibbonPersonIDCreator` int(10) unsigned zerofill NOT NULL,  `timestampCreator` timestamp NULL DEFAULT NULL,  `gibbonPersonIDUpdate` int(10) unsigned zerofill DEFAULT NULL,  `timestampUpdate` timestamp NULL DEFAULT NULL,  PRIMARY KEY (`gibbonFinanceFeeID`)) ENGINE=MyISAM DEFAULT CHARSET=utf8 ;end
INSERT INTO `gibbonaction` (`gibbonModuleID`, `name`, `precedence`, `category`, `description`, `URLList`, `entryURL`, `defaultPermissionAdmin`, `defaultPermissionTeacher`, `defaultPermissionStudent`, `defaultPermissionParent`, `defaultPermissionSupport`, `categoryPermissionStaff`, `categoryPermissionStudent`, `categoryPermissionParent`, `categoryPermissionOther`) VALUES ((SELECT gibbonModuleID FROM gibbonmodule WHERE name='Finance'), 'Manage Billing Schedule', 0, 'Admin', 'Allows users to create, view and edit billing windows.', 'billingSchedule_manage.php,billingSchedule_manage_edit.php,billingSchedule_manage_add.php', 'billingSchedule_manage.php', 'Y', 'N', 'N', 'N', 'N', 'Y', 'N', 'N', 'N') ;end
INSERT INTO `gibbonpermission` (`permissionID` ,`gibbonRoleID` ,`gibbonActionID`) VALUES (NULL , '1', (SELECT gibbonActionID FROM gibbonaction JOIN gibbonmodule ON (gibbonaction.gibbonModuleID=gibbonmodule.gibbonModuleID) WHERE gibbonmodule.name='Finance' AND gibbonaction.name='Manage Billing Schedule'));end
CREATE TABLE `gibbonfinancebillingschedule` (  `gibbonFinanceBillingScheduleID` int(6) unsigned zerofill NOT NULL AUTO_INCREMENT,  `gibbonSchoolYearID` int(3) unsigned zerofill NOT NULL,  `name` varchar(100) NOT NULL,  `description` text NOT NULL,  `active` enum('Y','N') NOT NULL DEFAULT 'Y',  `invoiceIssueDate` date DEFAULT NULL,  `invoiceDueDate` date DEFAULT NULL,  `gibbonPersonIDCreator` int(10) unsigned zerofill NOT NULL,  `timestampCreator` timestamp NULL DEFAULT NULL,  `gibbonPersonIDUpdate` int(10) unsigned zerofill DEFAULT NULL,  `timestampUpdate` timestamp NULL DEFAULT NULL,  PRIMARY KEY (`gibbonFinanceBillingScheduleID`)) ENGINE=MyISAM DEFAULT CHARSET=utf8 ;end
INSERT INTO `gibbonaction` (`gibbonModuleID`, `name`, `precedence`, `category`, `description`, `URLList`, `entryURL`, `defaultPermissionAdmin`, `defaultPermissionTeacher`, `defaultPermissionStudent`, `defaultPermissionParent`, `defaultPermissionSupport`, `categoryPermissionStaff`, `categoryPermissionStudent`, `categoryPermissionParent`, `categoryPermissionOther`) VALUES ((SELECT gibbonModuleID FROM gibbonmodule WHERE name='Finance'), 'Manage Invoices', 0, 'Billing', 'Allows users to generate, view, delete and edit invoices.', 'invoices_manage.php,invoices_manage_edit.php,invoices_manage_add.php,invoices_manage_delete.php,invoices_manage_view.php,invoices_manage_issue.php,invoices_manage_print.php', 'invoices_manage.php', 'Y', 'N', 'N', 'N', 'N', 'Y', 'N', 'N', 'N') ;end
INSERT INTO `gibbonpermission` (`permissionID` ,`gibbonRoleID` ,`gibbonActionID`) VALUES (NULL , '1', (SELECT gibbonActionID FROM gibbonaction JOIN gibbonmodule ON (gibbonaction.gibbonModuleID=gibbonmodule.gibbonModuleID) WHERE gibbonmodule.name='Finance' AND gibbonaction.name='Manage Invoices'));end
CREATE TABLE `gibbonfinanceinvoice` (  `gibbonFinanceInvoiceID` int(14) unsigned zerofill NOT NULL AUTO_INCREMENT,  `gibbonSchoolYearID` int(3) unsigned zerofill NOT NULL,  `gibbonFinanceInvoiceeID` int(10) unsigned zerofill NOT NULL,  `invoiceTo` enum('Family','Company') NOT NULL DEFAULT 'Family',  `billingScheduleType` enum('Scheduled','Ad Hoc') NOT NULL DEFAULT 'Ad Hoc', `separated` enum('N','Y') DEFAULT NULL COMMENT 'Has this invoice been separated from its schedule in gibbonfinancebillingschedule? Only applies to scheduled invoices. Separation takes place during invoice issueing.', `gibbonFinanceBillingScheduleID` int(6) unsigned zerofill DEFAULT NULL,  `status` enum('Pending','Issued','Paid','Cancelled','Refunded') NOT NULL DEFAULT 'Pending',  `invoiceIssueDate` date DEFAULT NULL,  `invoiceDueDate` date DEFAULT NULL,  `paidDate` date DEFAULT NULL,  `reminderCount` int(3) NOT NULL DEFAULT '0',  `notes` text NOT NULL,  `gibbonPersonIDCreator` int(10) unsigned zerofill NOT NULL,  `timestampCreator` timestamp NULL DEFAULT NULL,  `gibbonPersonIDUpdate` int(10) unsigned zerofill DEFAULT NULL,  `timestampUpdate` timestamp NULL DEFAULT NULL,  PRIMARY KEY (`gibbonFinanceInvoiceID`)) ENGINE=MyISAM  DEFAULT CHARSET=utf8 ;end
CREATE TABLE `gibbonfinanceinvoicefee` (  `gibbonFinanceInvoiceFeeID` int(15) unsigned zerofill NOT NULL AUTO_INCREMENT,  `gibbonFinanceInvoiceID` int(14) unsigned zerofill NOT NULL,  `feeType` enum('Standard','Ad Hoc') NOT NULL DEFAULT 'Ad Hoc',  `gibbonFinanceFeeID` int(6) unsigned zerofill DEFAULT NULL,  `separated` enum('N','Y') DEFAULT NULL COMMENT 'Has this fee been separated from its parent in gibbonfinancefee? Only applies to Standard fees. Separation takes place during invoice issueing.',  `name` varchar(100) DEFAULT NULL,  `description` text,  `gibbonFinanceFeeCategoryID` int(4) unsigned zerofill DEFAULT NULL,  `fee` decimal(12,2) DEFAULT NULL,  `sequenceNumber` int(10) DEFAULT NULL,  PRIMARY KEY (`gibbonFinanceInvoiceFeeID`)) ENGINE=MyISAM  DEFAULT CHARSET=utf8 ;end
INSERT INTO `gibbonaction` (`gibbonModuleID`, `name`, `precedence`, `category`, `description`, `URLList`, `entryURL`, `defaultPermissionAdmin`, `defaultPermissionTeacher`, `defaultPermissionStudent`, `defaultPermissionParent`, `defaultPermissionSupport`, `categoryPermissionStaff`, `categoryPermissionStudent`, `categoryPermissionParent`, `categoryPermissionOther`) VALUES ((SELECT gibbonModuleID FROM gibbonmodule WHERE name='Finance'), 'Invoice & Receipt Settings', 0, 'Billing', 'Allows users to edit the text that appears in invoices and receipts.', 'invoiceReceiptSettings.php', 'invoiceReceiptSettings.php', 'Y', 'N', 'N', 'N', 'N', 'Y', 'N', 'N', 'N') ;end
INSERT INTO `gibbonpermission` (`permissionID` ,`gibbonRoleID` ,`gibbonActionID`) VALUES (NULL , '1', (SELECT gibbonActionID FROM gibbonaction JOIN gibbonmodule ON (gibbonaction.gibbonModuleID=gibbonmodule.gibbonModuleID) WHERE gibbonmodule.name='Finance' AND gibbonaction.name='Invoice & Receipt Settings'));end
INSERT INTO `gibbonsetting` (`gibbonSystemSettingsID`, `scope`, `name`, `nameDisplay`, `description`, `value`) VALUES (NULL, 'Finance', 'invoiceText', 'Invoice Text', 'Text to appear in invoice, above invoice details and fees.', '');end
INSERT INTO `gibbonsetting` (`gibbonSystemSettingsID`, `scope`, `name`, `nameDisplay`, `description`, `value`) VALUES (NULL, 'Finance', 'invoiceNotes', 'Invoice Notes', 'Text to appear in invoice, below invoice details and fees.', '');end
INSERT INTO `gibbonsetting` (`gibbonSystemSettingsID`, `scope`, `name`, `nameDisplay`, `description`, `value`) VALUES (NULL, 'Finance', 'receiptText', 'Receipt Text', 'Text to appear in receipt, above receipt details and fees.', '');end
INSERT INTO `gibbonsetting` (`gibbonSystemSettingsID`, `scope`, `name`, `nameDisplay`, `description`, `value`) VALUES (NULL, 'Finance', 'receiptNotes', 'Receipt Notes', 'Text to appear in receipt, below receipt details and fees.', '');end
INSERT INTO `gibbonsetting` (`gibbonSystemSettingsID`, `scope`, `name`, `nameDisplay`, `description`, `value`) VALUES (NULL, 'Finance', 'reminder1Text', 'Reminder 1 Text', 'Text to appear in first level reminder level, above invoice details and fees.', '');end
INSERT INTO `gibbonsetting` (`gibbonSystemSettingsID`, `scope`, `name`, `nameDisplay`, `description`, `value`) VALUES (NULL, 'Finance', 'reminder2Text', 'Reminder 2 Text', 'Text to appear in second level reminder level, above invoice details and fees.', '');end
INSERT INTO `gibbonsetting` (`gibbonSystemSettingsID`, `scope`, `name`, `nameDisplay`, `description`, `value`) VALUES (NULL, 'Finance', 'reminder3Text', 'Reminder 3 Text', 'Text to appear in third level reminder level, above invoice details and fees.', '');end
INSERT INTO `gibbonsetting` (`gibbonSystemSettingsID`, `scope`, `name`, `nameDisplay`, `description`, `value`) VALUES (NULL, 'Finance', 'email', 'Email', 'Email address to send finance emails from.', '');end
INSERT INTO `gibbonaction` (`gibbonModuleID` ,`name` ,`precedence` ,`category` ,`description` ,`URLList` ,`entryURL` ,`defaultPermissionAdmin` ,`defaultPermissionTeacher` ,`defaultPermissionStudent` ,`defaultPermissionParent` ,`defaultPermissionSupport` ,`categoryPermissionStaff` ,`categoryPermissionStudent` ,`categoryPermissionParent` ,`categoryPermissionOther`) VALUES ((SELECT gibbonModuleID FROM gibbonmodule WHERE name='Data Updater'), 'Update Finance Data_any', 1, '', 'Create finance data update request for any user', 'data_finance.php', 'data_finance.php', 'Y', 'N', 'N', 'N', 'N', 'Y', 'N', 'N', 'N');end
INSERT INTO `gibbonpermission` (`permissionID` ,`gibbonRoleID` ,`gibbonActionID`) VALUES (NULL , '1', (SELECT gibbonActionID FROM gibbonaction JOIN gibbonmodule ON (gibbonaction.gibbonModuleID=gibbonmodule.gibbonModuleID) WHERE gibbonmodule.name='Data Updater' AND gibbonaction.name='Update Finance Data_any'));end
INSERT INTO `gibbonaction` (`gibbonModuleID` ,`name` ,`precedence` ,`category` ,`description` ,`URLList` ,`entryURL` ,`defaultPermissionAdmin` ,`defaultPermissionTeacher` ,`defaultPermissionStudent` ,`defaultPermissionParent` ,`defaultPermissionSupport` ,`categoryPermissionStaff` ,`categoryPermissionStudent` ,`categoryPermissionParent` ,`categoryPermissionOther`) VALUES ((SELECT gibbonModuleID FROM gibbonmodule WHERE name='Data Updater'), 'Update Finance Data_family', 0, '', 'Allows adults in a family to create finance data update request for their family.', 'data_finance.php', 'data_finance.php', 'Y', 'Y', 'N', 'Y', 'Y', 'Y', 'N', 'Y', 'N');end
INSERT INTO `gibbonpermission` (`permissionID` ,`gibbonRoleID` ,`gibbonActionID`) VALUES (NULL , '1', (SELECT gibbonActionID FROM gibbonaction JOIN gibbonmodule ON (gibbonaction.gibbonModuleID=gibbonmodule.gibbonModuleID) WHERE gibbonmodule.name='Data Updater' AND gibbonaction.name='Update Finance Data_family'));end
INSERT INTO `gibbonpermission` (`permissionID` ,`gibbonRoleID` ,`gibbonActionID`) VALUES (NULL , '2', (SELECT gibbonActionID FROM gibbonaction JOIN gibbonmodule ON (gibbonaction.gibbonModuleID=gibbonmodule.gibbonModuleID) WHERE gibbonmodule.name='Data Updater' AND gibbonaction.name='Update Finance Data_family'));end
INSERT INTO `gibbonpermission` (`permissionID` ,`gibbonRoleID` ,`gibbonActionID`) VALUES (NULL , '4', (SELECT gibbonActionID FROM gibbonaction JOIN gibbonmodule ON (gibbonaction.gibbonModuleID=gibbonmodule.gibbonModuleID) WHERE gibbonmodule.name='Data Updater' AND gibbonaction.name='Update Finance Data_family'));end
INSERT INTO `gibbonpermission` (`permissionID` ,`gibbonRoleID` ,`gibbonActionID`) VALUES (NULL , '6', (SELECT gibbonActionID FROM gibbonaction JOIN gibbonmodule ON (gibbonaction.gibbonModuleID=gibbonmodule.gibbonModuleID) WHERE gibbonmodule.name='Data Updater' AND gibbonaction.name='Update Finance Data_family'));end
CREATE TABLE `gibbonfinanceinvoiceeupdate` (  `gibbonFinanceInvoiceeUpdateID` int(12) unsigned zerofill NOT NULL AUTO_INCREMENT,  `status` enum('Pending','Complete') NOT NULL DEFAULT 'Pending',  `gibbonFinanceInvoiceeID` int(10) unsigned zerofill NOT NULL,  `invoiceTo` enum('Family','Company') NOT NULL,  `companyName` varchar(100) DEFAULT NULL,  `companyContact` varchar(100) DEFAULT NULL,  `companyAddress` varchar(255) DEFAULT NULL,  `companyEmail` varchar(255) DEFAULT NULL,  `companyPhone` varchar(20) DEFAULT NULL,  `companyAll` enum('Y','N') DEFAULT NULL COMMENT 'Should company pay all invoices?.',  `gibbonFinanceFeeCategoryIDList` text COMMENT 'If companyAll is N, list category IDs for campany to pay here.',  `gibbonPersonIDUpdater` int(10) unsigned zerofill NOT NULL,  `timestamp` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,  PRIMARY KEY (`gibbonFinanceInvoiceeUpdateID`)) ENGINE=MyISAM  DEFAULT CHARSET=utf8 ;end
INSERT INTO `gibbonaction` (`gibbonModuleID` ,`name` ,`precedence` ,`category` ,`description` ,`URLList` ,`entryURL` ,`defaultPermissionAdmin` ,`defaultPermissionTeacher` ,`defaultPermissionStudent` ,`defaultPermissionParent` ,`defaultPermissionSupport` ,`categoryPermissionStaff` ,`categoryPermissionStudent` ,`categoryPermissionParent` ,`categoryPermissionOther`) VALUES ((SELECT gibbonModuleID FROM gibbonmodule WHERE name='User Admin'), 'Finance Data Updates', 0, 'Data Updater', 'Manage requests for updates to finance data.', 'data_finance.php,data_finance_edit.php,data_finance_delete.php', 'data_finance.php', 'Y', 'N', 'N', 'N', 'N', 'Y', 'N', 'N', 'N');end
INSERT INTO `gibbonpermission` (`permissionID` ,`gibbonRoleID` ,`gibbonActionID`) VALUES (NULL , '1', (SELECT gibbonActionID FROM gibbonaction JOIN gibbonmodule ON (gibbonaction.gibbonModuleID=gibbonmodule.gibbonModuleID) WHERE gibbonmodule.name='User Admin' AND gibbonaction.name='Finance Data Updates'));end
ALTER TABLE `gibbonunit` ADD `embeddable` ENUM( 'N', 'Y' ) NOT NULL DEFAULT 'N' AFTER `details` ;end
UPDATE gibbonsetting SET name='notificationStudentDefault', nameDisplay='Student Notification Default', description='Should student acceptance email be turned on or off by default.' WHERE name='notificationDefault' AND scope='Application Form';end
INSERT INTO `gibbonsetting` (`gibbonSystemSettingsID` ,`scope` ,`name` ,`nameDisplay` ,`description` ,`value`)VALUES (NULL , 'Application Form', 'notificationParentsDefault', 'Parents Notification Default', 'Should parent acceptance email be turned on or off by default.', 'On');end
DELETE FROM gibbonaction WHERE name='Staff Gold Stars' AND gibbonModuleID=(SELECT gibbonModuleID FROM gibbonmodule WHERE name='Planner');end
UPDATE gibbonsetting SET scope='User Admin' WHERE scope='Application Form' AND (name='dayTypeOptions' OR name='dayTypeText');end
ALTER TABLE `gibbonperson` ADD `dayType` VARCHAR( 255 ) NULL DEFAULT NULL COMMENT 'Student day type, as specified in the application form.';end
INSERT INTO `gibbonsetting` (`gibbonSystemSettingsID` ,`scope` ,`name` ,`nameDisplay` ,`description` ,`value`) VALUES (NULL , 'User Admin', 'privacyOptions', 'Privacy Options', 'Comma-separated list of choices to make available if privacy options are turned on. If blank, privacy fields will not be displayed.', '');end
UPDATE gibbonsetting SET name='privacy', nameDisplay='Privacy', description='Should privacy options be turned on across the system?' WHERE scope='User Admin' AND name='imagePrivacy';end
UPDATE gibbonsetting SET name='privacyBlurb', nameDisplay='Privacy Blurb', description='Descriptive text to accompany image privacy option when shown to users.' WHERE scope='User Admin' AND name='imagePrivacyBlurb';end
ALTER TABLE `gibbonperson` CHANGE `imagePrivacy` `privacy` TEXT CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT NULL ;end
ALTER TABLE `gibbonapplicationform` CHANGE `imagePrivacy` `privacy` TEXT CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT NULL ;end
ALTER TABLE `gibbonpersonupdate` CHANGE `imagePrivacy` `privacy` TEXT CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT NULL ;end
INSERT INTO `gibbonaction` (`gibbonModuleID` ,`name` ,`precedence` ,`category` ,`description` ,`URLList` ,`entryURL` ,`defaultPermissionAdmin` ,`defaultPermissionTeacher` ,`defaultPermissionStudent` ,`defaultPermissionParent` ,`defaultPermissionSupport` ,`categoryPermissionStaff` ,`categoryPermissionStudent` ,`categoryPermissionParent` ,`categoryPermissionOther`) VALUES ((SELECT gibbonModuleID FROM gibbonmodule WHERE name='User Admin'), 'Sync Users', 0, 'Import', 'Import CSV file of users, and use it to create new users and set left user status.', 'import_users.php', 'import_users.php', 'Y', 'N', 'N', 'N', 'N', 'Y', 'N', 'N', 'N');end
INSERT INTO `gibbonpermission` (`permissionID` ,`gibbonRoleID` ,`gibbonActionID`) VALUES (NULL , '1', (SELECT gibbonActionID FROM gibbonaction JOIN gibbonmodule ON (gibbonaction.gibbonModuleID=gibbonmodule.gibbonModuleID) WHERE gibbonmodule.name='User Admin' AND gibbonaction.name='Sync Users'));end
ALTER TABLE `gibbonperson` CHANGE `username` `username` VARCHAR( 50 ) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL ;end
INSERT INTO `gibbonaction` (`gibbonModuleID` ,`name` ,`precedence` ,`category` ,`description` ,`URLList` ,`entryURL` ,`defaultPermissionAdmin` ,`defaultPermissionTeacher` ,`defaultPermissionStudent` ,`defaultPermissionParent` ,`defaultPermissionSupport` ,`categoryPermissionStaff` ,`categoryPermissionStudent` ,`categoryPermissionParent` ,`categoryPermissionOther`) VALUES ((SELECT gibbonModuleID FROM gibbonmodule WHERE name='User Admin'), 'Sync Student Enrolment', 0, 'Import', 'Import CSV file of students, and use it to register certain users as students.', 'import_studentEnrolment.php', 'import_studentEnrolment.php', 'Y', 'N', 'N', 'N', 'N', 'Y', 'N', 'N', 'N');end
INSERT INTO `gibbonpermission` (`permissionID` ,`gibbonRoleID` ,`gibbonActionID`) VALUES (NULL , '1', (SELECT gibbonActionID FROM gibbonaction JOIN gibbonmodule ON (gibbonaction.gibbonModuleID=gibbonmodule.gibbonModuleID) WHERE gibbonmodule.name='User Admin' AND gibbonaction.name='Sync Student Enrolment'));end
ALTER TABLE `gibbonfamily` ADD `familySync` VARCHAR( 50 ) NULL DEFAULT NULL ;end
INSERT INTO `gibbonaction` (`gibbonModuleID` ,`name` ,`precedence` ,`category` ,`description` ,`URLList` ,`entryURL` ,`defaultPermissionAdmin` ,`defaultPermissionTeacher` ,`defaultPermissionStudent` ,`defaultPermissionParent` ,`defaultPermissionSupport` ,`categoryPermissionStaff` ,`categoryPermissionStudent` ,`categoryPermissionParent` ,`categoryPermissionOther`) VALUES ((SELECT gibbonModuleID FROM gibbonmodule WHERE name='User Admin'), 'Sync Families', 0, 'Import', 'Import CSV files of families and their members, and use it to sync.', 'import_families.php', 'import_families.php', 'Y', 'N', 'N', 'N', 'N', 'Y', 'N', 'N', 'N');end
INSERT INTO `gibbonpermission` (`permissionID` ,`gibbonRoleID` ,`gibbonActionID`) VALUES (NULL , '1', (SELECT gibbonActionID FROM gibbonaction JOIN gibbonmodule ON (gibbonaction.gibbonModuleID=gibbonmodule.gibbonModuleID) WHERE gibbonmodule.name='User Admin' AND gibbonaction.name='Sync Families'));end
INSERT INTO `gibbonsetting` (`gibbonSystemSettingsID` ,`scope` ,`name` ,`nameDisplay` ,`description` ,`value`) VALUES (NULL , 'Planner', 'sharingDefaultParents', 'Sharing Default: Parents', 'When adding lessons and deploying units, should sharing default for parents be Y or N?', 'Y');end
INSERT INTO `gibbonsetting` (`gibbonSystemSettingsID` ,`scope` ,`name` ,`nameDisplay` ,`description` ,`value`) VALUES (NULL , 'Planner', 'sharingDefaultStudents', 'Sharing Default: Students', 'When adding lessons and deploying units, should sharing default for students be Y or N?', 'Y');end
INSERT INTO `gibbonmodule` (`gibbonModuleID`, `name`, `description`, `entryURL`, `type`, `active`, `category`, `version`, `author`, `url`) VALUES (NULL, 'Staff', 'Allows users to view staff information', 'staff_view.php', 'Core', 'Y', 'People', '', 'Ross Parker', 'http://rossparker.org');end
INSERT INTO `gibbonaction` (`gibbonActionID`, `gibbonModuleID`, `name`, `precedence`, `category`, `description`, `URLList`, `entryURL`, `entrySidebar`, `defaultPermissionAdmin`, `defaultPermissionTeacher`, `defaultPermissionStudent`, `defaultPermissionParent`, `defaultPermissionSupport`, `categoryPermissionStaff`, `categoryPermissionStudent`, `categoryPermissionParent`, `categoryPermissionOther`) VALUES (NULL, (SELECT gibbonModuleID FROM gibbonmodule WHERE name='Staff'), 'View Staff Profile_brief', 1, 'Profiles', 'View brief profile of any staff member in the school.', 'staff_view.php,staff_view_details.php', 'staff_view.php', 'Y', 'Y', 'N', 'N', 'N', 'N', 'Y', 'Y', 'Y', 'Y'), (NULL, (SELECT gibbonModuleID FROM gibbonmodule WHERE name='Staff'), 'View Staff Profile_full', 2, 'Profiles', 'View full profile of any staff member in the school.', 'staff_view.php,staff_view_details.php', 'staff_view', 'Y', 'Y', 'N', 'N', 'N', 'N', 'Y', 'Y', 'Y', 'y');end
INSERT INTO `gibbonpermission` (`permissionID` ,`gibbonRoleID` ,`gibbonActionID`) VALUES (NULL , '1', (SELECT gibbonActionID FROM gibbonaction JOIN gibbonmodule ON (gibbonaction.gibbonModuleID=gibbonmodule.gibbonModuleID) WHERE gibbonmodule.name='Staff' AND gibbonaction.name='View Staff Profile_brief'));end
INSERT INTO `gibbonpermission` (`permissionID` ,`gibbonRoleID` ,`gibbonActionID`) VALUES (NULL , '1', (SELECT gibbonActionID FROM gibbonaction JOIN gibbonmodule ON (gibbonaction.gibbonModuleID=gibbonmodule.gibbonModuleID) WHERE gibbonmodule.name='Staff' AND gibbonaction.name='View Staff Profile_full'));end
ALTER TABLE `gibbonpersonupdate` CHANGE `emergency1Name` `emergency1Name` VARCHAR(30) CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT NULL, CHANGE `emergency1Number1` `emergency1Number1` VARCHAR(30) CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT NULL, CHANGE `emergency1Number2` `emergency1Number2` VARCHAR(30) CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT NULL, CHANGE `emergency1Relationship` `emergency1Relationship` VARCHAR(30) CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT NULL, CHANGE `emergency2Name` `emergency2Name` VARCHAR(30) CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT NULL, CHANGE `emergency2Number1` `emergency2Number1` VARCHAR(30) CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT NULL, CHANGE `emergency2Number2` `emergency2Number2` VARCHAR(30) CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT NULL, CHANGE `emergency2Relationship` `emergency2Relationship` VARCHAR(30) CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT NULL;end
ALTER TABLE `gibbonpersonupdate` CHANGE `profession` `profession` VARCHAR( 30 ) CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT NULL ,CHANGE `employer` `employer` VARCHAR( 30 ) CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT NULL ,CHANGE `jobTitle` `jobTitle` VARCHAR( 30 ) CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT NULL ;end
ALTER TABLE `gibbonrollgroup` ADD `gibbonSpaceID` INT( 5 ) UNSIGNED ZEROFILL NULL DEFAULT NULL AFTER `gibbonPersonIDTutor3` ;end
INSERT INTO `gibbonmodule` (`gibbonModuleID`, `name`, `description`, `entryURL`, `type`, `active`, `category`, `version`, `author`, `url`) VALUES (NULL, 'Roll Groups', 'Allows users to view a listing of roll groups', 'rollGroups.php', 'Core', 'Y', 'People', '', 'Ross Parker', 'http://rossparker.org');end
INSERT INTO `gibbonaction` (`gibbonActionID`, `gibbonModuleID`, `name`, `precedence`, `category`, `description`, `URLList`, `entryURL`, `entrySidebar`, `defaultPermissionAdmin`, `defaultPermissionTeacher`, `defaultPermissionStudent`, `defaultPermissionParent`, `defaultPermissionSupport`, `categoryPermissionStaff`, `categoryPermissionStudent`, `categoryPermissionParent`, `categoryPermissionOther`) VALUES (NULL, (SELECT gibbonModuleID FROM gibbonmodule WHERE name='Roll Groups'), 'View Roll Groups', 1, '', 'View a brief profile of roll groups in school.', 'rollGroups.php,rollGroups_details.php', 'rollGroups.php', 'Y', 'Y', 'Y', 'Y', 'N', 'Y', 'Y', 'Y', 'Y', 'Y');end
INSERT INTO `gibbonpermission` (`permissionID` ,`gibbonRoleID` ,`gibbonActionID`) VALUES (NULL , '1', (SELECT gibbonActionID FROM gibbonaction JOIN gibbonmodule ON (gibbonaction.gibbonModuleID=gibbonmodule.gibbonModuleID) WHERE gibbonmodule.name='Roll Groups' AND gibbonaction.name='View Roll Groups'));end
INSERT INTO `gibbonpermission` (`permissionID` ,`gibbonRoleID` ,`gibbonActionID`) VALUES (NULL , '2', (SELECT gibbonActionID FROM gibbonaction JOIN gibbonmodule ON (gibbonaction.gibbonModuleID=gibbonmodule.gibbonModuleID) WHERE gibbonmodule.name='Roll Groups' AND gibbonaction.name='View Roll Groups'));end
INSERT INTO `gibbonpermission` (`permissionID` ,`gibbonRoleID` ,`gibbonActionID`) VALUES (NULL , '3', (SELECT gibbonActionID FROM gibbonaction JOIN gibbonmodule ON (gibbonaction.gibbonModuleID=gibbonmodule.gibbonModuleID) WHERE gibbonmodule.name='Roll Groups' AND gibbonaction.name='View Roll Groups'));end
INSERT INTO `gibbonpermission` (`permissionID` ,`gibbonRoleID` ,`gibbonActionID`) VALUES (NULL , '6', (SELECT gibbonActionID FROM gibbonaction JOIN gibbonmodule ON (gibbonaction.gibbonModuleID=gibbonmodule.gibbonModuleID) WHERE gibbonmodule.name='Roll Groups' AND gibbonaction.name='View Roll Groups'));end
ALTER TABLE `gibboncourse` ADD INDEX ( `gibbonSchoolYearID` ) ;end
ALTER TABLE `gibbonplannerentry` ADD INDEX ( `gibbonCourseClassID` ) ;end
ALTER TABLE `gibboncourseclass` ADD INDEX ( `gibbonCourseID` ) ;end
ALTER TABLE `gibboncourseclassperson` ADD INDEX ( `gibbonCourseClassID` ) ;end
ALTER TABLE `gibbonaction` ADD INDEX ( `gibbonModuleID` ) ;end
ALTER TABLE `gibbonpermission` ADD INDEX ( `gibbonRoleID` ) ;end
ALTER TABLE `gibbonpermission` ADD INDEX ( `gibbonActionID` ) ;end
ALTER TABLE `gibbonttcolumnrow` ADD INDEX ( `gibbonTTColumnID` ) ;end
ALTER TABLE `gibbonttdayrowclass` ADD INDEX ( `gibbonTTColumnRowID` ) ;end
ALTER TABLE `gibbonttdayrowclass` ADD INDEX ( `gibbonCourseClassID` ) ;end
ALTER TABLE `gibbonttdayrowclass` ADD INDEX ( `gibbonSpaceID` ) ;end
ALTER TABLE `gibbonttdaydate` ADD INDEX ( `gibbonTTDayID` ) ;end
ALTER TABLE `gibbonstudentenrolment` ADD INDEX ( `gibbonSchoolYearID` ) ;end
ALTER TABLE `gibbonstudentenrolment` ADD INDEX ( `gibbonYearGroupID` ) ;end
ALTER TABLE `gibbonstudentenrolment` ADD INDEX ( `gibbonRollGroupID` ) ;end
ALTER TABLE `gibbonbehaviour` ADD INDEX ( `gibbonPersonID` ) ;end
ALTER TABLE `gibbonresourcetag` ADD INDEX ( `tag` ) ;end
ALTER TABLE `gibbonpersonmedical` ADD INDEX ( `gibbonPersonID` ) ;end
ALTER TABLE `gibbonpersonmedicalcondition` ADD INDEX ( `gibbonPersonMedicalID` ) ;end
ALTER TABLE `gibbonmarkbookentry` ADD INDEX ( `gibbonPersonIDStudent` );end
ALTER TABLE `gibbonmarkbookentry` ADD INDEX ( `gibbonMarkbookColumnID` ) ;end
ALTER TABLE `gibbonmarkbookcolumn` ADD INDEX ( `gibbonCourseClassID` ) ;end
OPTIMIZE TABLE `gibbonaction`, `gibbonactivity`, `gibbonactivityslot`, `gibbonactivitystaff`, `gibbonactivitystudent`, `gibbonactivitystudentpayment`, `gibbonalertlevel`, `gibbonapplicationform`, `gibbonapplicationformfile`, `gibbonapplicationformrelationship`, `gibbonattendancelogperson`, `gibbonattendancelogrollgroup`, `gibbonbehaviour`, `gibboncountry`, `gibboncourse`, `gibboncourseclass`, `gibboncourseclassperson`, `gibboncrowdassessdiscuss`, `gibboncrowdassesslike`, `gibbondaysofweek`, `gibbondepartment`, `gibbondepartmentresource`, `gibbondepartmentstaff`, `gibbonexternalassessment`, `gibbonexternalassessmentfield`, `gibbonexternalassessmentstudent`, `gibbonexternalassessmentstudententry`, `gibbonfamily`, `gibbonfamilyadult`, `gibbonfamilychild`, `gibbonfamilyrelationship`, `gibbonfamilyupdate`, `gibbonfileextension`, `gibbonfinancebillingschedule`, `gibbonfinancefee`, `gibbonfinancefeecategory`, `gibbonfinanceinvoice`, `gibbonfinanceinvoicee`, `gibbonfinanceinvoiceeupdate`, `gibbonfinanceinvoicefee`, `gibbonhook`, `gibbonhouse`, `gibbonin`, `gibbonindescriptor`, `gibboninpersondescriptor`, `gibbonlibraryitem`, `gibbonlibraryitemevent`, `gibbonlibrarytype`, `gibbonmarkbookcolumn`, `gibbonmarkbookentry`, `gibbonmedicalcondition`, `gibbonmessenger`, `gibbonmessengertarget`, `gibbonmodule`, `gibbonoutcome`, `gibbonpermission`, `gibbonperson`, `gibbonpersonmedical`, `gibbonpersonmedicalcondition`, `gibbonpersonmedicalconditionupdate`, `gibbonpersonmedicalupdate`, `gibbonpersonupdate`, `gibbonplannerentry`, `gibbonplannerentryattendance`, `gibbonplannerentryattendancelog`, `gibbonplannerentrydiscuss`, `gibbonplannerentryguest`, `gibbonplannerentryhomework`, `gibbonplannerentrylike`, `gibbonplannerentryoutcome`, `gibbonplannerentrystudenttracker`, `gibbonresource`, `gibbonresourcetag`, `gibbonrole`, `gibbonrollgroup`, `gibbonrubric`, `gibbonrubriccell`, `gibbonrubriccolumn`, `gibbonrubricentry`, `gibbonrubricrow`, `gibbonscale`, `gibbonscalegrade`, `gibbonschoolyear`, `gibbonschoolyearspecialday`, `gibbonschoolyearterm`, `gibbonsetting`, `gibbonspace`, `gibbonstaff`, `gibbonstudentenrolment`, `gibbonstudentnote`, `gibbontheme`, `gibbontt`, `gibbonttcolumn`, `gibbonttcolumnrow`, `gibbonttday`, `gibbonttdaydate`, `gibbonttdayrowclass`, `gibbonttdayrowclassexception`, `gibbonttimport`, `gibbonunit`, `gibbonunitblock`, `gibbonunitclass`, `gibbonunitclassblock`, `gibbonunitoutcome`, `gibbonyeargroup`;end
UPDATE gibbonaction SET defaultPermissionTeacher='Y', defaultPermissionSupport='Y' WHERE gibbonModuleID=(SELECT gibbonModuleID FROM gibbonmodule WHERE gibbonmodule.name='Data Updater') AND gibbonaction.name='Update Personal Data_family';end
INSERT INTO `gibbonpermission` (`permissionID` ,`gibbonRoleID` ,`gibbonActionID`) VALUES (NULL , '2', (SELECT gibbonActionID FROM gibbonaction JOIN gibbonmodule ON (gibbonaction.gibbonModuleID=gibbonmodule.gibbonModuleID) WHERE gibbonmodule.name='Data Updater' AND gibbonaction.name='Update Personal Data_family'));end
INSERT INTO `gibbonpermission` (`permissionID` ,`gibbonRoleID` ,`gibbonActionID`) VALUES (NULL , '6', (SELECT gibbonActionID FROM gibbonaction JOIN gibbonmodule ON (gibbonaction.gibbonModuleID=gibbonmodule.gibbonModuleID) WHERE gibbonmodule.name='Data Updater' AND gibbonaction.name='Update Personal Data_family'));end
CREATE TABLE `gibbonstudentnotecategory` (  `gibbonStudentNoteCategoryID` int(5) unsigned zerofill NOT NULL AUTO_INCREMENT,  `name` varchar(30) NOT NULL,  `template` text NOT NULL,  `active` enum('Y','N') NOT NULL DEFAULT 'Y',  PRIMARY KEY (`gibbonStudentNoteCategoryID`)) ENGINE=MyISAM DEFAULT CHARSET=utf8 ;end
DELETE FROM `gibbonsetting` WHERE `scope`='Students' AND `name`='noteCategories' ;end
INSERT INTO `gibbonstudentnotecategory` (`gibbonStudentNoteCategoryID` ,`name` ,`template` ,`active`)VALUES (NULL , 'Academic', '', 'Y'), (NULL , 'Pastoral', '', 'Y'), (NULL , 'Behaviour', '', 'Y'), (NULL , 'Other', '', 'Y');end
UPDATE gibbonaction SET URLList='studentsSettings.php,studentsSettings_noteCategory_add.php,studentsSettings_noteCategory_edit.php,studentsSettings_noteCategory_delete.php' WHERE gibbonModuleID=(SELECT gibbonModuleID FROM gibbonmodule WHERE gibbonmodule.name='School Admin') AND gibbonaction.name='Manage Students Settings';end
ALTER TABLE `gibbonstudentnote` CHANGE `category` `gibbonStudentNoteCategoryID` INT( 5 ) UNSIGNED ZEROFILL NULL DEFAULT NULL ;end
UPDATE `gibbonstudentnote` SET gibbonStudentNoteCategoryID=NULL ;end
INSERT INTO `gibbontheme` (`gibbonThemeID` ,`name` ,`description` ,`active` ,`version` ,`author` ,`url`)VALUES (NULL , 'Olden', 'Gibbon''s 2012 look and feel.', 'N', '1.0.00', 'Ross Parker', 'http://rossparker.org');end
ALTER TABLE `gibbonperson` ADD `gibbonThemeIDPersonal` INT( 4 ) UNSIGNED ZEROFILL NULL DEFAULT NULL ;end
INSERT INTO `gibbonaction` (`gibbonActionID`, `gibbonModuleID`, `name`, `precedence`, `category`, `description`, `URLList`, `entryURL`, `entrySidebar`, `defaultPermissionAdmin`, `defaultPermissionTeacher`, `defaultPermissionStudent`, `defaultPermissionParent`, `defaultPermissionSupport`, `categoryPermissionStaff`, `categoryPermissionStudent`, `categoryPermissionParent`, `categoryPermissionOther`) VALUES (NULL, (SELECT gibbonModuleID FROM gibbonmodule WHERE name='School Admin'), 'Manage External Assessments', 1, 'ARR', 'Add, edit and delete external assessments.', 'externalAssessments_manage.php,externalAssessments_manage_edit.php,externalAssessments_manage_edit_field_add.php,externalAssessments_manage_edit_field_edit.php,externalAssessments_manage_edit_field_delete.php, externalAssessments_manage_add.php, externalAssessments_manage_delete.php', 'externalAssessments_manage.php', 'Y', 'Y', 'N', 'N', 'N', 'N', 'Y', 'N', 'N', 'N');end
INSERT INTO `gibbonpermission` (`permissionID` ,`gibbonRoleID` ,`gibbonActionID`) VALUES (NULL , '1', (SELECT gibbonActionID FROM gibbonaction JOIN gibbonmodule ON (gibbonaction.gibbonModuleID=gibbonmodule.gibbonModuleID) WHERE gibbonmodule.name='School Admin' AND gibbonaction.name='Manage External Assessments'));end
INSERT INTO `gibbonaction` (`gibbonActionID`, `gibbonModuleID`, `name`, `precedence`, `category`, `description`, `URLList`, `entryURL`, `entrySidebar`, `defaultPermissionAdmin`, `defaultPermissionTeacher`, `defaultPermissionStudent`, `defaultPermissionParent`, `defaultPermissionSupport`, `categoryPermissionStaff`, `categoryPermissionStudent`, `categoryPermissionParent`, `categoryPermissionOther`) VALUES (NULL, (SELECT gibbonModuleID FROM gibbonmodule WHERE name='Planner'), 'Staff Gold Stars', 0, 'Reports', 'A leaque table of staff gold stars...just for fun.', 'report_goldStars_staff.php', 'report_goldStars_staff.php', 'Y', 'Y', 'Y', 'N', 'N', 'N', 'Y', 'N', 'N', 'N');end
INSERT INTO `gibbonpermission` (`permissionID` ,`gibbonRoleID` ,`gibbonActionID`) VALUES (NULL , '1', (SELECT gibbonActionID FROM gibbonaction JOIN gibbonmodule ON (gibbonaction.gibbonModuleID=gibbonmodule.gibbonModuleID) WHERE gibbonmodule.name='Planner' AND gibbonaction.name='Staff Gold Stars'));end
INSERT INTO `gibbonpermission` (`permissionID` ,`gibbonRoleID` ,`gibbonActionID`) VALUES (NULL , '2', (SELECT gibbonActionID FROM gibbonaction JOIN gibbonmodule ON (gibbonaction.gibbonModuleID=gibbonmodule.gibbonModuleID) WHERE gibbonmodule.name='Planner' AND gibbonaction.name='Staff Gold Stars'));end
";


//v7.0.01
$count++ ;
$sql[$count][0]="7.0.01" ;
$sql[$count][1]="";


//v7.1.00
$count++ ;
$sql[$count][0]="7.1.00" ;
$sql[$count][1]="
ALTER TABLE `gibbonapplicationform` CHANGE `timestamp` `timestamp` TIMESTAMP NULL DEFAULT NULL ;end
ALTER TABLE `gibbonapplicationform` DROP `otherNames`;end
ALTER TABLE `gibbonapplicationform` DROP `parent1otherNames`, DROP `parent2otherNames`;end
ALTER TABLE `gibbonperson` DROP `otherNames` ;end
ALTER TABLE `gibbonpersonupdate` DROP `otherNames` ;end
ALTER TABLE `gibbonstaff` ADD `countryOfOrigin` VARCHAR( 80 ) NOT NULL , ADD `qualifications` VARCHAR( 255 ) NOT NULL , ADD `biography` TEXT NOT NULL ;end
ALTER TABLE `gibbonstaff` ADD `biographicalGrouping` VARCHAR( 100 ) NOT NULL COMMENT 'Used for group staff when creating a staff directory.';end
ALTER TABLE `gibbonstaff` ADD `biographicalGroupingPriority` INT( 3 ) NOT NULL AFTER `biographicalGrouping` ;end
INSERT INTO `gibbonsetting` (`gibbonSystemSettingsID`, `scope`, `name`, `nameDisplay`, `description`, `value`) VALUES (NULL, 'Students', 'extendedBriefProfile', 'Extended Brief Profile', 'The extended version of the brief student profile includes contact information of parents.', 'N');end
INSERT INTO `gibbonpermission` (`permissionID` ,`gibbonRoleID` ,`gibbonActionID`) VALUES (NULL , '4', (SELECT gibbonActionID FROM gibbonaction JOIN gibbonmodule ON (gibbonaction.gibbonModuleID=gibbonmodule.gibbonModuleID) WHERE gibbonmodule.name='Roll Groups' AND gibbonaction.name='View Roll Groups'));end
ALTER TABLE `gibbonapplicationform` CHANGE `parent1title` `parent1title` VARCHAR( 5 ) CHARACTER SET utf8 COLLATE utf8_general_ci NULL ;end
ALTER TABLE `gibbonapplicationform` CHANGE `parent1surname` `parent1surname` VARCHAR( 30 ) CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT '',CHANGE `parent1firstName` `parent1firstName` VARCHAR( 30 ) CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT '',CHANGE `parent1preferredName` `parent1preferredName` VARCHAR( 30 ) CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT '',CHANGE `parent1officialName` `parent1officialName` VARCHAR( 150 ) CHARACTER SET utf8 COLLATE utf8_general_ci NULL ,CHANGE `parent1nameInCharacters` `parent1nameInCharacters` VARCHAR( 20 ) CHARACTER SET utf8 COLLATE utf8_general_ci NULL ,CHANGE `parent1gender` `parent1gender` ENUM( 'M', 'F' ) CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT 'M';end
ALTER TABLE `gibbonapplicationform` CHANGE `parent1relationship` `parent1relationship` VARCHAR( 50 ) CHARACTER SET utf8 COLLATE utf8_general_ci NULL ,CHANGE `parent1languageFirst` `parent1languageFirst` VARCHAR( 30 ) CHARACTER SET utf8 COLLATE utf8_general_ci NULL ,CHANGE `parent1languageSecond` `parent1languageSecond` VARCHAR( 30 ) CHARACTER SET utf8 COLLATE utf8_general_ci NULL ,CHANGE `parent1citizenship1` `parent1citizenship1` VARCHAR( 255 ) CHARACTER SET utf8 COLLATE utf8_general_ci NULL ,CHANGE `parent1nationalIDCardNumber` `parent1nationalIDCardNumber` VARCHAR( 30 ) CHARACTER SET utf8 COLLATE utf8_general_ci NULL ,CHANGE `parent1residencyStatus` `parent1residencyStatus` VARCHAR( 255 ) CHARACTER SET utf8 COLLATE utf8_general_ci NULL ,CHANGE `parent1visaExpiryDate` `parent1visaExpiryDate` DATE NULL DEFAULT NULL ;end
ALTER TABLE `gibbonapplicationform` CHANGE `parent1phone1Type` `parent1phone1Type` ENUM('','Mobile','Home','Work','Fax','Pager','Other') CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT '', CHANGE `parent1phone1CountryCode` `parent1phone1CountryCode` VARCHAR(7) CHARACTER SET utf8 COLLATE utf8_general_ci NULL, CHANGE `parent1phone1` `parent1phone1` VARCHAR(20) CHARACTER SET utf8 COLLATE utf8_general_ci NULL, CHANGE `parent1phone2Type` `parent1phone2Type` ENUM('','Mobile','Home','Work','Fax','Pager','Other') CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT '', CHANGE `parent1phone2CountryCode` `parent1phone2CountryCode` VARCHAR(7) CHARACTER SET utf8 COLLATE utf8_general_ci NULL, CHANGE `parent1phone2` `parent1phone2` VARCHAR(20) CHARACTER SET utf8 COLLATE utf8_general_ci NULL, CHANGE `parent1profession` `parent1profession` VARCHAR(30) CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT NULL, CHANGE `parent1employer` `parent1employer` VARCHAR(30) CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT NULL;end
ALTER TABLE `gibbonapplicationform` CHANGE `parent2title` `parent2title` VARCHAR(5) CHARACTER SET utf8 COLLATE utf8_general_ci NULL, CHANGE `parent2surname` `parent2surname` VARCHAR(30) CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT '', CHANGE `parent2firstName` `parent2firstName` VARCHAR(30) CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT '', CHANGE `parent2preferredName` `parent2preferredName` VARCHAR(30) CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT '', CHANGE `parent2officialName` `parent2officialName` VARCHAR(150) CHARACTER SET utf8 COLLATE utf8_general_ci NULL, CHANGE `parent2nameInCharacters` `parent2nameInCharacters` VARCHAR(20) CHARACTER SET utf8 COLLATE utf8_general_ci NULL, CHANGE `parent2gender` `parent2gender` ENUM('M','F') CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT 'M', CHANGE `parent2relationship` `parent2relationship` VARCHAR(50) CHARACTER SET utf8 COLLATE utf8_general_ci NULL, CHANGE `parent2languageFirst` `parent2languageFirst` VARCHAR(30) CHARACTER SET utf8 COLLATE utf8_general_ci NULL, CHANGE `parent2languageSecond` `parent2languageSecond` VARCHAR(30) CHARACTER SET utf8 COLLATE utf8_general_ci NULL, CHANGE `parent2citizenship1` `parent2citizenship1` VARCHAR(255) CHARACTER SET utf8 COLLATE utf8_general_ci NULL, CHANGE `parent2nationalIDCardNumber` `parent2nationalIDCardNumber` VARCHAR(30) CHARACTER SET utf8 COLLATE utf8_general_ci NULL, CHANGE `parent2residencyStatus` `parent2residencyStatus` VARCHAR(255) CHARACTER SET utf8 COLLATE utf8_general_ci NULL, CHANGE `parent2visaExpiryDate` `parent2visaExpiryDate` DATE NULL DEFAULT NULL;end
ALTER TABLE `gibbonapplicationform` CHANGE `parent2phone1Type` `parent2phone1Type` ENUM('','Mobile','Home','Work','Fax','Pager','Other') CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT '', CHANGE `parent2phone1CountryCode` `parent2phone1CountryCode` VARCHAR(7) CHARACTER SET utf8 COLLATE utf8_general_ci NULL, CHANGE `parent2phone1` `parent2phone1` VARCHAR(20) CHARACTER SET utf8 COLLATE utf8_general_ci NULL, CHANGE `parent2phone2Type` `parent2phone2Type` ENUM('','Mobile','Home','Work','Fax','Pager','Other') CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT '', CHANGE `parent2phone2CountryCode` `parent2phone2CountryCode` VARCHAR(7) CHARACTER SET utf8 COLLATE utf8_general_ci NULL, CHANGE `parent2phone2` `parent2phone2` VARCHAR(20) CHARACTER SET utf8 COLLATE utf8_general_ci NULL, CHANGE `parent2profession` `parent2profession` VARCHAR(30) CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT NULL, CHANGE `parent2employer` `parent2employer` VARCHAR(30) CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT NULL;end
ALTER TABLE `gibbonapplicationform` CHANGE `agreement` `agreement` ENUM( 'N', 'Y' ) CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT NULL ;end
ALTER TABLE `gibbonapplicationform` CHANGE `homeAddress` `homeAddress` MEDIUMTEXT CHARACTER SET utf8 COLLATE utf8_general_ci NULL ,CHANGE `homeAddressDistrict` `homeAddressDistrict` VARCHAR( 255 ) CHARACTER SET utf8 COLLATE utf8_general_ci NULL ,CHANGE `homeAddressCountry` `homeAddressCountry` VARCHAR( 255 ) CHARACTER SET utf8 COLLATE utf8_general_ci NULL ;end
ALTER TABLE `gibbonfinanceinvoicee` ADD `companyCCFamily` ENUM( 'N', 'Y' ) NULL DEFAULT NULL COMMENT 'When company is billed, should family receive a copy?' AFTER `companyEmail` ;end
ALTER TABLE `gibbonfinanceinvoiceeupdate` ADD `companyCCFamily` ENUM( 'N', 'Y' ) NULL DEFAULT NULL COMMENT 'When company is billed, should family receive a copy?' AFTER `companyEmail` ;end
ALTER TABLE `gibbonapplicationform` ADD `companyCCFamily` ENUM( 'N', 'Y' ) NULL DEFAULT NULL COMMENT 'When company is billed, should family receive a copy?' AFTER `companyEmail` ;end
INSERT INTO `gibbonsetting` (`gibbonSystemSettingsID` ,`scope` ,`name` ,`nameDisplay` ,`description` ,`value`)VALUES (NULL , 'Application Form', 'notificationParentsMessage', 'Parents Notification Message', 'A custom message to add to the standard email to parents on acceptance.', '');end
INSERT INTO `gibbonsetting` (`gibbonSystemSettingsID` ,`scope` ,`name` ,`nameDisplay` ,`description` ,`value`)VALUES (NULL , 'Application Form', 'notificationStudentMessage', 'Student Notification Message', 'A custom message to add to the standard email to students on acceptance.', '');end
INSERT INTO `gibbonsetting` (`gibbonSystemSettingsID`, `scope`, `name`, `nameDisplay`, `description`, `value`) VALUES (NULL, 'Finance', 'invoiceNumber', 'Invoice Number Style', 'How should invoice numbers be constructed?', 'Invoice ID');end
ALTER TABLE `gibbonstaff` ADD `initials` VARCHAR( 4 ) NULL DEFAULT NULL AFTER `type` ,ADD UNIQUE (`initials`);end
INSERT INTO `gibbonaction` (`gibbonActionID`, `gibbonModuleID`, `name`, `precedence`, `category`, `description`, `URLList`, `entryURL`, `entrySidebar`, `defaultPermissionAdmin`, `defaultPermissionTeacher`, `defaultPermissionStudent`, `defaultPermissionParent`, `defaultPermissionSupport`, `categoryPermissionStaff`, `categoryPermissionStudent`, `categoryPermissionParent`, `categoryPermissionOther`) VALUES (NULL, (SELECT gibbonModuleID FROM gibbonmodule WHERE name='Markbook'), 'Edit Markbook_everything', 4, '', 'Allows editing of any column in any class.', 'markbook_edit.php, markbook_edit_add.php,markbook_edit_addMulti.php,markbook_edit_edit.php, markbook_edit_delete.php,markbook_edit_data.php', 'markbook_edit.php', 'Y', 'N', 'N', 'N', 'N', 'N', 'Y', 'N', 'N', 'N');end
INSERT INTO `gibbonpermission` (`permissionID` ,`gibbonRoleID` ,`gibbonActionID`) VALUES (NULL , '1', (SELECT gibbonActionID FROM gibbonaction JOIN gibbonmodule ON (gibbonaction.gibbonModuleID=gibbonmodule.gibbonModuleID) WHERE gibbonmodule.name='Markbook' AND gibbonaction.name='Edit Markbook_everything'));end
ALTER TABLE `gibbonfinanceinvoice` ADD `paidAmount` DECIMAL( 13, 2 ) NULL DEFAULT NULL COMMENT 'The final amount paid' AFTER `paidDate` ;end
ALTER TABLE `gibbonattendancelogperson` ADD INDEX ( `date` ) ;end
CREATE TABLE `gibbondistrict` (  `gibbonDistrictID` int(6) unsigned zerofill NOT NULL AUTO_INCREMENT,  `name` varchar(30) NOT NULL,  PRIMARY KEY (`gibbonDistrictID`)) ENGINE=InnoDB DEFAULT CHARSET=utf8 AUTO_INCREMENT=1 ;end
UPDATE `gibbonaction` SET defaultPermissionAdmin='Y' WHERE gibbonModuleID=(SELECT gibbonModuleID FROM gibbonmodule WHERE name='Markbook') AND gibbonaction.name='Edit Markbook_everything';end
INSERT INTO `gibbonaction` (`gibbonActionID`, `gibbonModuleID`, `name`, `precedence`, `category`, `description`, `URLList`, `entryURL`, `entrySidebar`, `defaultPermissionAdmin`, `defaultPermissionTeacher`, `defaultPermissionStudent`, `defaultPermissionParent`, `defaultPermissionSupport`, `categoryPermissionStaff`, `categoryPermissionStudent`, `categoryPermissionParent`, `categoryPermissionOther`) VALUES (NULL, (SELECT gibbonModuleID FROM gibbonmodule WHERE name='User Admin'), 'Manage Districts', 0, 'User Management', 'Manage a list of districts for address autocomplete.', 'district_manage.php, district_manage_add.php, district_manage_edit.php, district_manage_delete.php', 'district_manage.php', 'Y', 'Y', 'N', 'N', 'N', 'N', 'Y', 'N', 'N', 'N');end
INSERT INTO `gibbonpermission` (`permissionID` ,`gibbonRoleID` ,`gibbonActionID`) VALUES (NULL , '1', (SELECT gibbonActionID FROM gibbonaction JOIN gibbonmodule ON (gibbonaction.gibbonModuleID=gibbonmodule.gibbonModuleID) WHERE gibbonmodule.name='User Admin' AND gibbonaction.name='Manage Districts'));end
UPDATE gibbonlibrarytype SET fields='a:16:{i:0;a:6:{s:4:\"name\";s:11:\"Form Factor\";s:11:\"description\";s:0:\"\";s:4:\"type\";s:6:\"Select\";s:7:\"options\";s:50:\"Desktop, Laptop, Tablet, Phone, Set-Top Box, Other\";s:7:\"default\";s:6:\"Laptop\";s:8:\"required\";s:1:\"Y\";}i:1;a:6:{s:4:\"name\";s:16:\"Operating System\";s:11:\"description\";s:0:\"\";s:4:\"type\";s:4:\"Text\";s:7:\"options\";s:2:\"50\";s:7:\"default\";s:0:\"\";s:8:\"required\";s:1:\"N\";}i:2;a:6:{s:4:\"name\";s:13:\"Serial Number\";s:11:\"description\";s:0:\"\";s:4:\"type\";s:4:\"Text\";s:7:\"options\";s:2:\"50\";s:7:\"default\";s:0:\"\";s:8:\"required\";s:1:\"N\";}i:3;a:6:{s:4:\"name\";s:10:\"Model Name\";s:11:\"description\";s:0:\"\";s:4:\"type\";s:4:\"Text\";s:7:\"options\";s:2:\"50\";s:7:\"default\";s:0:\"\";s:8:\"required\";s:1:\"N\";}i:4;a:6:{s:4:\"name\";s:8:\"Model ID\";s:11:\"description\";s:0:\"\";s:4:\"type\";s:4:\"Text\";s:7:\"options\";s:2:\"50\";s:7:\"default\";s:0:\"\";s:8:\"required\";s:1:\"N\";}i:5;a:6:{s:4:\"name\";s:8:\"CPU Type\";s:11:\"description\";s:0:\"\";s:4:\"type\";s:4:\"Text\";s:7:\"options\";s:2:\"50\";s:7:\"default\";s:0:\"\";s:8:\"required\";s:1:\"N\";}i:6;a:6:{s:4:\"name\";s:9:\"CPU Speed\";s:11:\"description\";s:7:\"In GHz.\";s:4:\"type\";s:4:\"Text\";s:7:\"options\";s:1:\"6\";s:7:\"default\";s:0:\"\";s:8:\"required\";s:1:\"N\";}i:7;a:6:{s:4:\"name\";s:6:\"Memory\";s:11:\"description\";s:17:\"Total RAM, in GB.\";s:4:\"type\";s:4:\"Text\";s:7:\"options\";s:1:\"6\";s:7:\"default\";s:0:\"\";s:8:\"required\";s:1:\"N\";}i:8;a:6:{s:4:\"name\";s:7:\"Storage\";s:11:\"description\";s:30:\"Total HDD/SDD capacity, in GB.\";s:4:\"type\";s:4:\"Text\";s:7:\"options\";s:1:\"6\";s:7:\"default\";s:0:\"\";s:8:\"required\";s:1:\"N\";}i:9;a:6:{s:4:\"name\";s:20:\"Wireless MAC Address\";s:11:\"description\";s:0:\"\";s:4:\"type\";s:4:\"Text\";s:7:\"options\";s:2:\"17\";s:7:\"default\";s:0:\"\";s:8:\"required\";s:1:\"N\";}i:10;a:6:{s:4:\"name\";s:17:\"Wired MAC Address\";s:11:\"description\";s:0:\"\";s:4:\"type\";s:4:\"Text\";s:7:\"options\";s:2:\"17\";s:7:\"default\";s:0:\"\";s:8:\"required\";s:1:\"N\";}i:11;a:6:{s:4:\"name\";s:11:\"Accessories\";s:11:\"description\";s:43:\"Any chargers, display dongles, remotes etc?\";s:4:\"type\";s:4:\"Text\";s:7:\"options\";s:3:\"255\";s:7:\"default\";s:0:\"\";s:8:\"required\";s:1:\"N\";}i:12;a:6:{s:4:\"name\";s:15:\"Warranty Number\";s:11:\"description\";s:0:\"\";s:4:\"type\";s:4:\"Text\";s:7:\"options\";s:2:\"50\";s:7:\"default\";s:0:\"\";s:8:\"required\";s:1:\"N\";}i:13;a:6:{s:4:\"name\";s:15:\"Warranty Expiry\";s:11:\"description\";s:19:\"Format: dd/mm/yyyy.\";s:4:\"type\";s:4:\"Date\";s:7:\"options\";s:0:\"\";s:7:\"default\";s:0:\"\";s:8:\"required\";s:1:\"N\";}i:14;a:6:{s:4:\"name\";s:19:\"Last Reinstall Date\";s:11:\"description\";s:19:\"Format: dd/mm/yyyy.\";s:4:\"type\";s:4:\"Date\";s:7:\"options\";s:0:\"\";s:7:\"default\";s:0:\"\";s:8:\"required\";s:1:\"N\";}i:15;a:6:{s:4:\"name\";s:16:\"Repair Log/Notes\";s:11:\"description\";s:0:\"\";s:4:\"type\";s:8:\"Textarea\";s:7:\"options\";s:2:\"10\";s:7:\"default\";s:0:\"\";s:8:\"required\";s:1:\"N\";}}' WHERE name='Computer';end
";

//v7.1.01
$count++ ;
$sql[$count][0]="7.1.01" ;
$sql[$count][1]="
ALTER TABLE `gibbonapplicationform` ADD `paypalPaymentTransactionID` VARCHAR( 50 ) NOT NULL AFTER `paypalPaymentPayerID` , ADD `paypalPaymentReceiptID` VARCHAR( 50 ) NOT NULL AFTER `paypalPaymentTransactionID` ;end
";

//v7.1.02
$count++ ;
$sql[$count][0]="7.1.02" ;
$sql[$count][1]="

INSERT INTO `gibbonsetting` (`gibbonSystemSettingsID`, `scope`, `name`, `nameDisplay`, `description`, `value`) VALUES (NULL, 'User Admin', 'departureReasons', 'Departure Reasons', 'Comma-separated list of reasons for departure from school. If blank, user can enter any text.', '');end
INSERT INTO `gibbonsetting` (`gibbonSystemSettingsID`, `scope`, `name`, `nameDisplay`, `description`, `value`) VALUES (NULL, 'User Admin', 'googleOAuth', 'Google OAuth', 'Enable OAuth login via a Google Account.', 'N');end
INSERT INTO `gibbonsetting` (`gibbonSystemSettingsID`, `scope`, `name`, `nameDisplay`, `description`, `value`) VALUES (NULL, 'User Admin', 'googleOAuthDomains', 'Google OAuth Domains', 'If Google OAuth is enabled, what domains should we match on. Comma-separated list.', '');end
INSERT INTO `gibbonaction` (`gibbonActionID`, `gibbonModuleID`, `name`, `precedence`, `category`, `description`, `URLList`, `entryURL`, `entrySidebar`, `defaultPermissionAdmin`, `defaultPermissionTeacher`, `defaultPermissionStudent`, `defaultPermissionParent`, `defaultPermissionSupport`, `categoryPermissionStaff`, `categoryPermissionStudent`, `categoryPermissionParent`, `categoryPermissionOther`) VALUES (NULL, (SELECT gibbonModuleID FROM gibbonmodule WHERE name='Students'), 'Letters Home by Roll Group', 0, 'Reports', 'Show students in roll group, less those with an older sibling, so that letters can be carried home by oldest in family.', 'report_lettersHome_byRollGroup.php', 'report_lettersHome_byRollGroup.php', 'Y', 'Y', 'N', 'N', 'N', 'N', 'Y', 'N', 'N', 'N');end
INSERT INTO `gibbonpermission` (`permissionID` ,`gibbonRoleID` ,`gibbonActionID`) VALUES (NULL , '1', (SELECT gibbonActionID FROM gibbonaction JOIN gibbonmodule ON (gibbonaction.gibbonModuleID=gibbonmodule.gibbonModuleID) WHERE gibbonmodule.name='Students' AND gibbonaction.name='Letters Home by Roll Group'));end
INSERT INTO `gibbonsetting` (`gibbonSystemSettingsID`, `scope`, `name`, `nameDisplay`, `description`, `value`) VALUES (NULL, 'User Admin', 'googleClientName', 'Google Developers Client Name', 'Name of Google Project in Devlopers Console.', '');end
INSERT INTO `gibbonsetting` (`gibbonSystemSettingsID`, `scope`, `name`, `nameDisplay`, `description`, `value`) VALUES (NULL, 'User Admin', 'googleClientID', 'Google Developers Client ID', 'Client ID for Google Project In Developers Console.', '');end
INSERT INTO `gibbonsetting` (`gibbonSystemSettingsID`, `scope`, `name`, `nameDisplay`, `description`, `value`) VALUES (NULL, 'User Admin', 'googleClientSecret', 'Google Developers Client Secret', 'Client Secret for Google Project In Developers Console.', '');end
INSERT INTO `gibbonsetting` (`gibbonSystemSettingsID`, `scope`, `name`, `nameDisplay`, `description`, `value`) VALUES (NULL, 'User Admin', 'googleRedirectUri', 'Google Developers Redirect Url', 'Google Redirect on sucessful auth.', '');end
INSERT INTO `gibbonsetting` (`gibbonSystemSettingsID`, `scope`, `name`, `nameDisplay`, `description`, `value`) VALUES (NULL, 'User Admin', 'googleDeveloperKey', 'Google Developers Developer Key', 'Google project Developer Key.', '');end
ALTER TABLE gibbonperson ADD INDEX (username,email) ;end
DELETE  FROM `gibbonsetting` WHERE name='googleOAuthDomains';end
";

//v8.0.00
$count++ ;
$sql[$count][0]="8.0.00" ;
$sql[$count][1]="
INSERT INTO `gibbonpermission` (`permissionID` ,`gibbonRoleID` ,`gibbonActionID`) VALUES (NULL , '1', (SELECT gibbonActionID FROM gibbonaction JOIN gibbonmodule ON (gibbonaction.gibbonModuleID=gibbonmodule.gibbonModuleID) WHERE gibbonmodule.name='User Admin' AND gibbonaction.name='Manage Districts'));end
ALTER TABLE `gibbondistrict` ENGINE=MYISAM ;end
CREATE TABLE `gibboni18n` (  `gibboni18nID` int(4) unsigned zerofill NOT NULL AUTO_INCREMENT,  `code` varchar(5) NOT NULL,  `name` varchar(50) NOT NULL,  `systemDefault` enum('Y','N') NOT NULL DEFAULT 'N',  `maintainerName` varchar(100) NOT NULL,  `maintainerWebsite` varchar(255) NOT NULL,  `dateFormat` varchar(20) NOT NULL,  `currencyCode` varchar(3) NOT NULL COMMENT '3-char',  `currencySymbol` varchar(1) NOT NULL,  PRIMARY KEY (`gibboni18nID`)) ENGINE=MyISAM  DEFAULT CHARSET=utf8 ;end
INSERT INTO `gibboni18n` (`gibboni18nID`, `code`, `name`, `systemDefault`, `maintainerName`, `maintainerWebsite`, `dateFormat`, `currencyCode`, `currencySymbol`) VALUES(0001, 'en-GB', 'English - United Kingdom', 'Y', 'Gibbon', 'http://gibbonedu.org', 'd-m-Y', 'GBP', '£'),(0002, 'en-US', 'English - United States', 'N', 'Gibbon', 'http://gibbonedu.org', 'm-d-Y', 'USD', '$'),(0003, 'es', 'Español', 'N', 'International College Hong Kong (ICHK)', 'http://www.ichk.edu.hk', 'd-m-Y', 'EUR', '€'),(0004, 'zh-CN', '汉语 - 中国', 'N', 'International College Hong Kong (ICHK)', 'http://www.ichk.edu.hk', 'Y-m-d', 'CNY', '¥');end
INSERT INTO `gibbonaction` (`gibbonActionID`, `gibbonModuleID`, `name`, `precedence`, `category`, `description`, `URLList`, `entryURL`, `entrySidebar`, `defaultPermissionAdmin`, `defaultPermissionTeacher`, `defaultPermissionStudent`, `defaultPermissionParent`, `defaultPermissionSupport`, `categoryPermissionStaff`, `categoryPermissionStudent`, `categoryPermissionParent`, `categoryPermissionOther`) VALUES (NULL, (SELECT gibbonModuleID FROM gibbonmodule WHERE name='System Admin'), 'Language Settings', 0, '', 'Allows administrators to control system-wide language and localisation settings.', 'i18n_manage.php', 'i18n_manage.php', 'Y', 'Y', 'N', 'N', 'N', 'N', 'Y', 'N', 'N', 'N');end
INSERT INTO `gibbonpermission` (`permissionID` ,`gibbonRoleID` ,`gibbonActionID`) VALUES (NULL , '1', (SELECT gibbonActionID FROM gibbonaction JOIN gibbonmodule ON (gibbonaction.gibbonModuleID=gibbonmodule.gibbonModuleID) WHERE gibbonmodule.name='System Admin' AND gibbonaction.name='Language Settings'));end
ALTER TABLE `gibbonperson` ADD `gibboni18nIDPersonal` INT( 4 ) UNSIGNED ZEROFILL NULL DEFAULT NULL ;end
UPDATE gibboni18n SET dateFormat='d/m/Y' WHERE code='en-GB';end
UPDATE gibboni18n SET dateFormat='m/d/Y' WHERE code='en-US';end
UPDATE gibboni18n SET dateFormat='d/m/Y' WHERE code='es';end
INSERT INTO `gibboni18n` (`code`, `name`, `systemDefault`, `maintainerName`, `maintainerWebsite`, `dateFormat`, `currencyCode`, `currencySymbol`) VALUES ('zh-HK', '體字 - 香港', 'N', 'International College Hong Kong (ICHK)', 'http://www.ichk.edu.hk', 'Y-m-d', 'HKD', '$');end
ALTER TABLE `gibboni18n` CHANGE `dateFormat` `dateFormatPHP` VARCHAR( 20 ) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL ;end
ALTER TABLE `gibboni18n` ADD `dateFormat` VARCHAR( 20 ) NOT NULL AFTER maintainerWebsite ,ADD `dateFormatRegEx` VARCHAR( 255 ) NOT NULL AFTER dateFormat ;end
UPDATE gibboni18n SET dateFormat='dd/mm/yyyy' WHERE code='en-GB';end
UPDATE gibboni18n SET dateFormat='mm/dd/yyyy' WHERE code='en-US';end
UPDATE gibboni18n SET dateFormat='dd/mm/yyyy' WHERE code='es';end
UPDATE gibboni18n SET dateFormat='yyyy-mm-dd' WHERE code='zh-CN';end
UPDATE gibboni18n SET dateFormat='dd/mm/yyyy' WHERE code='zh-HK';end
UPDATE gibboni18n SET dateFormatRegEx='/^(0[1-9]|[12][0-9]|3[01])[- /.](0[1-9]|1[012])[- /.](19|20)\d\d$/i' WHERE code='en-GB';end
UPDATE gibboni18n SET dateFormatRegEx='/^(0[1-9]|[12][0-9]|3[01])[- /.](0[1-9]|1[012])[- /.](19|20)\d\d$/i' WHERE code='es';end
UPDATE gibboni18n SET dateFormatRegEx='/^(0[1-9]|[12][0-9]|3[01])[- /.](0[1-9]|1[012])[- /.](19|20)\d\d$/i' WHERE code='zh-HK';end
UPDATE gibboni18n SET dateFormatRegEx='/(0[1-9]|1[012])[- /.](0[1-9]|[12][0-9]|3[01])[- /.](19|20\d\d)/' WHERE code='en-US';end
UPDATE gibboni18n SET dateFormatRegEx='/^[0-9]{4}-(0[1-9]|1[0-2])-(0[1-9]|[1-2][0-9]|3[0-1])$/' WHERE code='zh-CN';end
UPDATE gibboni18n SET dateFormatPHP='d/m/Y' WHERE code='zh-HK';end
ALTER TABLE `gibboni18n` CHANGE `dateFormatRegEx` `dateFormatRegEx` TEXT CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL ;end
UPDATE gibboni18n SET dateFormatRegEx='/^(0[1-9]|[12][0-9]|3[01])[- /.](0[1-9]|1[012])[- /.](19|20)\\d\\d$/i' WHERE code='en-GB';end
UPDATE gibboni18n SET dateFormatRegEx='/^(0[1-9]|[12][0-9]|3[01])[- /.](0[1-9]|1[012])[- /.](19|20)\\d\\d$/i' WHERE code='es';end
UPDATE gibboni18n SET dateFormatRegEx='/^(0[1-9]|[12][0-9]|3[01])[- /.](0[1-9]|1[012])[- /.](19|20)\\d\\d$/i' WHERE code='zh-HK';end
UPDATE gibbonaction SET URLList='markbook_edit.php, markbook_edit_add.php, markbook_edit_edit.php, markbook_edit_delete.php,markbook_edit_data.php,markbook_edit_targets.php' WHERE name='Edit Markbook_singleClass' AND gibbonModuleID=(SELECT gibbonModuleID FROM gibbonmodule WHERE gibbonmodule.name='Markbook') ;end
UPDATE gibbonaction SET URLList='markbook_edit.php, markbook_edit_add.php,markbook_edit_addMulti.php,markbook_edit_edit.php, markbook_edit_delete.php,markbook_edit_data.php,markbook_edit_targets.php' WHERE name LIKE 'Edit Markbook%' AND NOT name='Edit Markbook_singleClass' AND gibbonModuleID=(SELECT gibbonModuleID FROM gibbonmodule WHERE gibbonmodule.name='Markbook') ;end
ALTER TABLE `gibbonmarkbookentry` CHANGE `gibbonPersonIDStudent` `gibbonPersonIDStudent` INT( 10 ) UNSIGNED ZEROFILL NOT NULL ;end
CREATE TABLE `gibbonmarkbooktarget` (  `gibbonMarkbookTargetID` int(14) unsigned zerofill NOT NULL AUTO_INCREMENT,  `gibbonCourseClassID` int(8) unsigned zerofill NOT NULL,  `gibbonPersonIDStudent` int(10) unsigned zerofill NOT NULL,  `gibbonScaleGradeID` int(7) NOT NULL,  PRIMARY KEY (`gibbonMarkbookTargetID`),  UNIQUE KEY `coursePerson` (`gibbonCourseClassID`,`gibbonPersonIDStudent`)) ENGINE=MyISAM DEFAULT CHARSET=utf8 ;end
INSERT INTO `gibbonsetting` (`gibbonSystemSettingsID`, `scope`, `name`, `nameDisplay`, `description`, `value`) VALUES (NULL, 'Markbook', 'personalisedWarnings', 'Personalised Warnings', 'Should markbook warnings be based on personal targets, if they are available?', 'Y');end
ALTER TABLE `gibbonactivity` ADD `provider` ENUM( 'School', 'External' ) NOT NULL DEFAULT 'School' AFTER `name` ;end
INSERT INTO `gibbonsetting` (`gibbonSystemSettingsID`, `scope`, `name`, `nameDisplay`, `description`, `value`) VALUES (NULL, 'Activities', 'disableExternalProviderSignup', 'Disable External Provider Signup', 'Should we turn off the option to sign up for activities provided by an outside agency?', 'N');end
INSERT INTO `gibbonsetting` (`gibbonSystemSettingsID`, `scope`, `name`, `nameDisplay`, `description`, `value`) VALUES (NULL, 'Activities', 'hideExternalProviderCost', 'Hide External Provider Cost', 'Should we hide the cost of activities provided by an outside agency from the Activities View?', 'N');end
INSERT INTO `gibbonaction` (`gibbonActionID`, `gibbonModuleID`, `name`, `precedence`, `category`, `description`, `URLList`, `entryURL`, `entrySidebar`, `defaultPermissionAdmin`, `defaultPermissionTeacher`, `defaultPermissionStudent`, `defaultPermissionParent`, `defaultPermissionSupport`, `categoryPermissionStaff`, `categoryPermissionStudent`, `categoryPermissionParent`, `categoryPermissionOther`) VALUES (NULL, (SELECT gibbonModuleID FROM gibbonmodule WHERE name='Students'), 'Privacy Choices by Student', 0, 'Reports', 'Shows privacy options selected, for those students with a selection made.', 'report_privacy_student.php', 'report_privacy_student.php', 'Y', 'Y', 'Y', 'N', 'N', 'N', 'Y', 'N', 'N', 'N');end
INSERT INTO `gibbonpermission` (`permissionID` ,`gibbonRoleID` ,`gibbonActionID`) VALUES (NULL , '1', (SELECT gibbonActionID FROM gibbonaction JOIN gibbonmodule ON (gibbonaction.gibbonModuleID=gibbonmodule.gibbonModuleID) WHERE gibbonmodule.name='Students' AND gibbonaction.name='Privacy Choices by Student'));end
INSERT INTO `gibbonpermission` (`permissionID` ,`gibbonRoleID` ,`gibbonActionID`) VALUES (NULL , '2', (SELECT gibbonActionID FROM gibbonaction JOIN gibbonmodule ON (gibbonaction.gibbonModuleID=gibbonmodule.gibbonModuleID) WHERE gibbonmodule.name='Students' AND gibbonaction.name='Privacy Choices by Student'));end
ALTER TABLE `gibbonmarkbookentry` CHANGE `attainmentConcern` `attainmentConcern` ENUM( 'N', 'Y', 'P' ) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL COMMENT '''P'' denotes that student has exceed their personal target';end
ALTER TABLE `gibbonmarkbooktarget` CHANGE `gibbonScaleGradeID` `gibbonScaleGradeID` INT( 7 ) NULL DEFAULT NULL ;end
ALTER TABLE `gibbonmarkbookentry` CHANGE `attainmentDescriptor` `attainmentDescriptor` VARCHAR( 100 ) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL , CHANGE `effortDescriptor` `effortDescriptor` VARCHAR( 100 ) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL ;end
UPDATE gibboni18n SET name='Español - España', code='es_ES' WHERE code='ES';end
UPDATE gibboni18n SET code='en_GB' WHERE code='en-GB';end
UPDATE gibboni18n SET code='en_US' WHERE code='en-US';end
UPDATE gibboni18n SET code='zh_CN' WHERE code='zh-CN';end
UPDATE gibboni18n SET code='zh_HK' WHERE code='zh-HK';end
UPDATE gibboni18n SET dateFormatRegEx='/(0[1-9]|1[012])[- /.](0[1-9]|[12][0-9]|3[01])[- /.](19|20\\d\\d)/' WHERE code='en_US';end
ALTER TABLE `gibbonapplicationform` CHANGE `status` `status` ENUM( 'Pending', 'Waiting List', 'Accepted', 'Rejected', 'Withdrawn' ) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT 'Pending';end
UPDATE gibbonaction SET category='User Management' WHERE name='Student Enrolment' AND gibbonModuleID=(SELECT gibbonModuleID FROM gibbonmodule WHERE gibbonmodule.name='User Admin') ;end
UPDATE gibbonmodule SET category='Assessment' WHERE category='ARR';end
UPDATE gibbonmodule SET category='Learning' WHERE category='T&L';end
INSERT INTO `gibbonsetting` (`gibbonSystemSettingsID`, `scope`, `name`, `nameDisplay`, `description`, `value`) VALUES (NULL, 'System', 'cuttingEdgeCode', 'Cutting Edge Code', 'Are you running cutting edge code, instead of stable versions?', 'N');end
INSERT INTO `gibbonsetting` (`gibbonSystemSettingsID`, `scope`, `name`, `nameDisplay`, `description`, `value`) VALUES (NULL, 'System', 'cuttingEdgeCodeLine', 'Cutting Edge Code Line', 'What line of SQL code did the last cutting edge update hit?', '');end
INSERT INTO `gibbonsetting` (`gibbonSystemSettingsID`, `scope`, `name`, `nameDisplay`, `description`, `value`) VALUES (NULL, 'System', 'gibboneduComOrganisationName', 'gibbonedu.com Organisation Name', 'Name of organisation, as registered with gibbonedu.com, for access to value-added services.', '');end
INSERT INTO `gibbonsetting` (`gibbonSystemSettingsID`, `scope`, `name`, `nameDisplay`, `description`, `value`) VALUES (NULL, 'System', 'gibboneduComOrganisationKey', 'gibbonedu.com Organisation Key', 'Organisation\'s private key, as registered with gibbonedu.com, for access to value-added services.', '');end
ALTER TABLE `gibboncourseclassperson` ADD `reportable` ENUM('Y','N') NOT NULL DEFAULT 'Y' ;end
ALTER TABLE `gibboni18n` CHANGE `currencySymbol` `currencySymbol` VARCHAR(3) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL;end
INSERT INTO `gibboni18n` (`gibboni18nID`, `code`, `name`, `systemDefault`, `maintainerName`, `maintainerWebsite`, `dateFormat`, `dateFormatRegEx`, `dateFormatPHP`, `currencyCode`, `currencySymbol`) VALUES (NULL, 'pl_PL', 'Język Polski - Polska', 'N', 'Arek Gladki', '', 'dd/mm/yyyy', '/^(0[1-9]|[12][0-9]|3[01])[- /.](0[1-9]|1[012])[- /.](19|20)\\\\d\\\\d$/i', 'd/m/Y', 'PLN', 'zł');end
UPDATE gibboni18n SET name='Język polski - Polska' WHERE code='pl_PL';end
CREATE TABLE `gibbonpayment` (  `gibbonPaymentID` int(14) unsigned zerofill NOT NULL AUTO_INCREMENT,  `foreignTable` varchar(50) NOT NULL,  `foreignTableID` int(14) unsigned zerofill NOT NULL,  `gateway` enum('Paypal') NOT NULL,  `paymentToken` varchar(50) NOT NULL,  `paymentPayerID` varchar(50) NOT NULL,  `paymentTransactionID` varchar(50) NOT NULL,  `paymentReceiptID` varchar(50) NOT NULL,  `timestamp` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,  PRIMARY KEY (`gibbonPaymentID`)) DEFAULT CHARSET=utf8 ;end
ALTER TABLE `gibbonapplicationform`  DROP `paypalPaymentToken`,  DROP `paypalPaymentPayerID`,  DROP `paypalPaymentTransactionID`,  DROP `paypalPaymentReceiptID`;end
ALTER TABLE `gibbonapplicationform` ADD `gibbonPaymentID` INT(14) UNSIGNED ZEROFILL NULL DEFAULT NULL AFTER `paymentMade`;end
ALTER TABLE `gibbonpayment` ADD `status` ENUM('Success','Failure') NOT NULL DEFAULT 'Success' AFTER `gateway`;end
INSERT INTO `gibbonaction` (`gibbonModuleID` ,`name` ,`precedence` ,`category` ,`description` ,`URLList` ,`entryURL` ,`defaultPermissionAdmin` ,`defaultPermissionTeacher` ,`defaultPermissionStudent` ,`defaultPermissionParent` ,`defaultPermissionSupport` ,`categoryPermissionStaff` ,`categoryPermissionStudent` ,`categoryPermissionParent` ,`categoryPermissionOther`) VALUES ((SELECT gibbonModuleID FROM gibbonmodule WHERE name='Timetable'), 'View Available Teachers', 0, 'Reports', 'View unassigned teachers by timetable.', 'report_viewAvailableTeachers.php', 'report_viewAvailableTeachers.php', 'Y', 'N', 'N', 'N', 'N', 'Y', 'Y', 'Y', 'Y');end
INSERT INTO `gibbonpermission` (`permissionID` ,`gibbonRoleID` ,`gibbonActionID`) VALUES (NULL , '1', (SELECT gibbonActionID FROM gibbonaction JOIN gibbonmodule ON (gibbonaction.gibbonModuleID=gibbonmodule.gibbonModuleID) WHERE gibbonmodule.name='Timetable' AND gibbonaction.name='View Available Teachers'));end
ALTER TABLE `gibboni18n` ADD `active` ENUM('Y','N') NOT NULL DEFAULT 'Y' AFTER `name`;end
UPDATE gibboni18n SET active='N' WHERE NOT code='en_GB';end
INSERT INTO `gibbonaction` (`gibbonActionID`, `gibbonModuleID`, `name`, `precedence`, `category`, `description`, `URLList`, `entryURL`, `entrySidebar`, `defaultPermissionAdmin`, `defaultPermissionTeacher`, `defaultPermissionStudent`, `defaultPermissionParent`, `defaultPermissionSupport`, `categoryPermissionStaff`, `categoryPermissionStudent`, `categoryPermissionParent`, `categoryPermissionOther`) VALUES (NULL, (SELECT gibbonModuleID FROM gibbonmodule WHERE name='Activities'), 'Copy Activities', 0, 'Actions', 'This action copies all current activities, slots and staff into a specified year.', 'activities_copy.php', 'activities_copy.php', 'Y', 'Y', 'N', 'N', 'N', 'N', 'Y', 'N', 'N', 'N');end
INSERT INTO `gibbonpermission` (`permissionID` ,`gibbonRoleID` ,`gibbonActionID`) VALUES (NULL , '1', (SELECT gibbonActionID FROM gibbonaction JOIN gibbonmodule ON (gibbonaction.gibbonModuleID=gibbonmodule.gibbonModuleID) WHERE gibbonmodule.name='Activities' AND gibbonaction.name='Copy Activities'));end
ALTER TABLE `gibbonpayment` CHANGE `paymentPayerID` `paymentPayerID` VARCHAR(50) CHARACTER SET utf8 COLLATE utf8_general_ci NULL;end
UPDATE gibbonaction SET category='Assessment' WHERE category='ARR';end
ALTER TABLE `gibbonpayment` CHANGE `paymentToken` `paymentToken` VARCHAR(50) CHARACTER SET utf8 COLLATE utf8_general_ci NULL, CHANGE `paymentTransactionID` `paymentTransactionID` VARCHAR(50) CHARACTER SET utf8 COLLATE utf8_general_ci NULL, CHANGE `paymentReceiptID` `paymentReceiptID` VARCHAR(50) CHARACTER SET utf8 COLLATE utf8_general_ci NULL;end
UPDATE gibboni18n SET active='Y' WHERE code='en_US';end
ALTER TABLE `gibboni18n` DROP `currencyCode`, DROP `currencySymbol`;end
UPDATE `gibbonaction` SET `name` = 'Activity Enrolment Summary', `description` = 'View summary enrolment information for all activities in the current year.' WHERE `gibbonaction`.`name` = 'Activity Enrollment Summary';end
UPDATE gibbonmodule SET description='Allows a school to issue invoices and track payments.' WHERE name='Finance';end
";

//v8.0.01
$count++ ;
$sql[$count][0]="8.0.01" ;
$sql[$count][1]="" ;

//v8.0.02
$count++ ;
$sql[$count][0]="8.0.02" ;
$sql[$count][1]="" ;

//v8.0.03
$count++ ;
$sql[$count][0]="8.0.03" ;
$sql[$count][1]="" ;

//v8.0.04
$count++ ;
$sql[$count][0]="8.0.04" ;
$sql[$count][1]="" ;

//v8.0.05
$count++ ;
$sql[$count][0]="8.0.05" ;
$sql[$count][1]="
UPDATE `gibbonaction` SET entrySidebar='N' WHERE gibbonModuleID=(SELECT gibbonModuleID FROM gibbonmodule WHERE name='User Admin') AND gibbonaction.name='Manage Permissions';end
UPDATE `gibbonaction` SET URLList='role_manage.php,role_manage_add.php,role_manage_edit.php,role_manage_delete.php,role_manage_duplicate.php' WHERE gibbonModuleID=(SELECT gibbonModuleID FROM gibbonmodule WHERE name='User Admin') AND gibbonaction.name='Manage Roles';end
" ;

//v8.0.06
$count++ ;
$sql[$count][0]="8.0.06" ;
$sql[$count][1]="" ;

//v8.1.00
$count++ ;
$sql[$count][0]="8.1.00" ;
$sql[$count][1]="
CREATE TABLE `gibbonplannerentrystudenthomework` (  `gibbonPlannerEntryStudentHomeworkID` int(14) unsigned zerofill NOT NULL AUTO_INCREMENT,  `gibbonPlannerEntryID` int(14) unsigned zerofill NOT NULL,  `gibbonPersonID` int(10) NOT NULL,  `homeworkDueDateTime` datetime NOT NULL,  `homeworkDetails` mediumtext NOT NULL,  `homeworkComplete` enum('Y','N') NOT NULL DEFAULT 'N',  PRIMARY KEY (`gibbonPlannerEntryStudentHomeworkID`)) ENGINE=MyISAM DEFAULT CHARSET=utf8 COMMENT='Allows students to add homework deadlines themselves' ;end
ALTER TABLE `gibbonplannerentrystudenthomework` ADD INDEX( `gibbonPlannerEntryID`, `gibbonPersonID`);end
UPDATE gibboni18n SET dateFormatRegEx='/(0[1-9]|1[012])[- /.](0[1-9]|[12][0-9]|3[01])[- /.](19|20\\\d\\\d)/' WHERE code='en_US';end
INSERT INTO `gibboni18n` (`code`, `name`, `active`, `systemDefault`, `maintainerName`, `maintainerWebsite`, `dateFormat`, `dateFormatRegEx`, `dateFormatPHP`) VALUES ('it_IT', 'Italiano - Italia', 'Y', 'N', 'Carmine Sirignano', '', 'dd/mm/yyyy', '/^(0[1-9]|[12][0-9]|3[01])[- /.](0[1-9]|1[012])[- /.](19|20)\\\d\\\d$/i', 'd/m/Y');end
CREATE TABLE `gibbonplannerparentweeklyemailsummary` (  `gibbonPlannerParentWeeklyEmailSummaryID` int(14) unsigned zerofill NOT NULL AUTO_INCREMENT,  `gibbonSchoolYearID` int(3) unsigned zerofill NOT NULL,  `gibbonPersonIDParent` int(10) unsigned zerofill NOT NULL,  `gibbonPersonIDStudent` int(10) unsigned zerofill NOT NULL,  `weekOfYear` int(2) NOT NULL,  `key` varchar(40) NOT NULL,  `confirmed` enum('N','Y') NOT NULL DEFAULT 'Y',  PRIMARY KEY (`gibbonPlannerParentWeeklyEmailSummaryID`),  UNIQUE KEY `key` (`key`)) ENGINE=MyISAM  DEFAULT CHARSET=utf8 ;end
INSERT INTO `gibbonaction` (`gibbonActionID`, `gibbonModuleID`, `name`, `precedence`, `category`, `description`, `URLList`, `entryURL`, `entrySidebar`, `defaultPermissionAdmin`, `defaultPermissionTeacher`, `defaultPermissionStudent`, `defaultPermissionParent`, `defaultPermissionSupport`, `categoryPermissionStaff`, `categoryPermissionStudent`, `categoryPermissionParent`, `categoryPermissionOther`) VALUES (NULL, (SELECT gibbonModuleID FROM gibbonmodule WHERE name='Planner'), 'Parent Weekly Email Summary', 0, 'Reports', 'This report shows responses to the weekly summary email, organised by calendar week and role group.', 'report_parentWeeklyEmailSummaryConfirmation.php', 'report_parentWeeklyEmailSummaryConfirmation.php', 'Y', 'Y', 'Y', 'N', 'N', 'N', 'Y', 'N', 'N', 'N');end
INSERT INTO `gibbonpermission` (`permissionID` ,`gibbonRoleID` ,`gibbonActionID`) VALUES (NULL , '1', (SELECT gibbonActionID FROM gibbonaction JOIN gibbonmodule ON (gibbonaction.gibbonModuleID=gibbonmodule.gibbonModuleID) WHERE gibbonmodule.name='Planner' AND gibbonaction.name='Parent Weekly Email Summary'));end
INSERT INTO `gibbonpermission` (`permissionID` ,`gibbonRoleID` ,`gibbonActionID`) VALUES (NULL , '2', (SELECT gibbonActionID FROM gibbonaction JOIN gibbonmodule ON (gibbonaction.gibbonModuleID=gibbonmodule.gibbonModuleID) WHERE gibbonmodule.name='Planner' AND gibbonaction.name='Parent Weekly Email Summary'));end
ALTER TABLE `gibbonplannerparentweeklyemailsummary` CHANGE `confirmed` `confirmed` ENUM('N','Y') CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL DEFAULT 'N';end
ALTER TABLE `gibbonplannerentry` DROP `twitterSearch`;end
ALTER TABLE `gibbonperson` CHANGE `username` `username` VARCHAR(20) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL;end
INSERT INTO `gibbonsetting` (`gibbonSystemSettingsID` ,`scope` ,`name` ,`nameDisplay` ,`description` ,`value`)VALUES (NULL , 'Application Form', 'studentDefaultEmail', 'Student Default Email', 'Set default email for students on acceptance, using [username] to insert username.', '');end
INSERT INTO `gibbonsetting` (`gibbonSystemSettingsID` ,`scope` ,`name` ,`nameDisplay` ,`description` ,`value`)VALUES (NULL , 'Application Form', 'studentDefaultWebsite', 'Student Default Website', 'Set default website for students on acceptance, using [username] to insert username.', '');end
" ;

//v8.2.00
$count++ ;
$sql[$count][0]="8.2.00" ;
$sql[$count][1]="
CREATE TABLE `gibbonnotification` (`gibbonNotificationID` int(10) unsigned zerofill NOT NULL AUTO_INCREMENT,  `gibbonPersonID` int(10) unsigned zerofill NOT NULL,  `gibbonModuleID` int(4) unsigned zerofill DEFAULT NULL,  `text` text NOT NULL, `actionLink` varchar(255) NOT NULL COMMENT 'Relative to absoluteURL, start with a forward slash', `actionText` varchar(255) NOT NULL,  `timestamp` datetime NOT NULL,  PRIMARY KEY (`gibbonNotificationID`)) ENGINE=InnoDB DEFAULT CHARSET=utf8 ;end
ALTER TABLE `gibbonnotification` DROP `actionText`;end
ALTER TABLE `gibbonnotification` ADD `count` INT(4) NOT NULL DEFAULT '1' AFTER `gibbonModuleID`;end
ALTER TABLE `gibbonactivity` ADD `registration` ENUM('Y','N') NOT NULL DEFAULT 'Y' COMMENT 'Can a parent/student select this for registration?' AFTER `active`;end
ALTER TABLE `gibbonmessengertarget` CHANGE `type` `type` ENUM('Class','Course','Roll Group','Year Group','Activity','Role','Applicants','Individuals','Houses','Role Category') CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL;end
ALTER TABLE `gibbonmessengertarget` CHANGE `id` `id` VARCHAR(30) NOT NULL;end
INSERT INTO `gibbonsetting` (`gibbonSystemSettingsID` ,`scope` ,`name` ,`nameDisplay` ,`description` ,`value`)VALUES (NULL , 'School Admin', 'studentAgreementOptions', 'Student Agreement Options', 'Comma-separated list of agreements that students might be asked to sign in school (e.g. ICT Policy).', '');end
ALTER TABLE `gibbonperson` ADD `studentAgreements` TEXT NOT NULL ;end
UPDATE gibbonaction SET entrySidebar='N' WHERE name='Age & Gender Summary' AND gibbonModuleID=(SELECT gibbonModuleID FROM gibbonmodule WHERE name='Students');end
INSERT INTO `gibbonsetting` (`gibbonSystemSettingsID` ,`scope` ,`name` ,`nameDisplay` ,`description` ,`value`)VALUES (NULL , 'Markbook', 'attainmentAlternativeName', 'Attainment Alternative Name', 'A name to use isntead of \"Attainment\" in the first grade column of the markbook.', '');end
INSERT INTO `gibbonsetting` (`gibbonSystemSettingsID` ,`scope` ,`name` ,`nameDisplay` ,`description` ,`value`)VALUES (NULL , 'Markbook', 'effortAlternativeName', 'Effort Alternative Name', 'A name to use isntead of \"Effort\" in the second grade column of the markbook.', '');end
INSERT INTO `gibbonsetting` (`gibbonSystemSettingsID` ,`scope` ,`name` ,`nameDisplay` ,`description` ,`value`)VALUES (NULL , 'Markbook', 'attainmentAlternativeNameAbrev', 'Attainment Alternative Name Abbreviation', 'A short name to use isntead of \"Attainment\" in the first grade column of the markbook.', '');end
INSERT INTO `gibbonsetting` (`gibbonSystemSettingsID` ,`scope` ,`name` ,`nameDisplay` ,`description` ,`value`)VALUES (NULL , 'Markbook', 'effortAlternativeNameAbrev', 'Effort Alternative Name Abbreviation', 'A short name to use isntead of \"Effort\" in the second grade column of the markbook.', '');end
INSERT INTO `gibbonaction` (`gibbonModuleID` ,`name` ,`precedence` ,`category` ,`description` ,`URLList` ,`entryURL` ,`defaultPermissionAdmin` ,`defaultPermissionTeacher` ,`defaultPermissionStudent` ,`defaultPermissionParent` ,`defaultPermissionSupport` ,`categoryPermissionStaff` ,`categoryPermissionStudent` ,`categoryPermissionParent` ,`categoryPermissionOther`) VALUES ((SELECT gibbonModuleID FROM gibbonmodule WHERE name='External Assessment'), 'Import Assessment Results', 0, '', 'Import CSV file of results, to update matching records and create new records where none exist.', 'import_results.php', 'import_results.php', 'Y', 'N', 'N', 'N', 'N', 'Y', 'N', 'N', 'N');end
INSERT INTO `gibbonpermission` (`permissionID` ,`gibbonRoleID` ,`gibbonActionID`) VALUES (NULL , '1', (SELECT gibbonActionID FROM gibbonaction JOIN gibbonmodule ON (gibbonaction.gibbonModuleID=gibbonmodule.gibbonModuleID) WHERE gibbonmodule.name='External Assessment' AND gibbonaction.name='Import Assessment Results'));end
UPDATE gibbonaction SET entryURL='externalAssessment.php' WHERE name='External Assessment Data_manage' AND gibbonModuleID=(SELECT gibbonModuleID FROM gibbonmodule WHERE name='External Assessment');end
ALTER TABLE `gibbonperson` CHANGE `studentAgreements` `studentAgreements` TEXT CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT NULL;end
CREATE TABLE `gibbonttspacechange` (  `gibbonTTSpaceChangeID` int(12) unsigned zerofill NOT NULL AUTO_INCREMENT,  `gibbonTTDayRowClassID` int(12) unsigned zerofill NOT NULL,  `gibbonSpaceID` int(5) unsigned zerofill DEFAULT NULL,  `date` date NOT NULL,  `gibbonPersonID` int(12) unsigned zerofill NOT NULL,  PRIMARY KEY (`gibbonTTSpaceChangeID`),  KEY `gibbonTTDayRowClassID` (`gibbonTTDayRowClassID`),  KEY `date` (`date`)) ENGINE=MyISAM  DEFAULT CHARSET=utf8 ;end
INSERT INTO `gibbonaction` (`gibbonActionID`, `gibbonModuleID`, `name`, `precedence`, `category`, `description`, `URLList`, `entryURL`, `entrySidebar`, `defaultPermissionAdmin`, `defaultPermissionTeacher`, `defaultPermissionStudent`, `defaultPermissionParent`, `defaultPermissionSupport`, `categoryPermissionStaff`, `categoryPermissionStudent`, `categoryPermissionParent`, `categoryPermissionOther`) VALUES (NULL, (SELECT gibbonModuleID FROM gibbonmodule WHERE name='Timetable'), 'Manage Space Changes_allClasses', 0, 'Spaces', 'Allows a user to create and manage one-off location changes for all classes within the timetable.', 'spaceChange_manage.php,spaceChange_manage_add.php,spaceChange_manage_edit.php,spaceChange_manage_delete.php','spaceChange_manage.php', 'Y', 'Y', 'N', 'N', 'N', 'N', 'Y', 'N', 'N', 'N');end
INSERT INTO `gibbonpermission` (`permissionID` ,`gibbonRoleID` ,`gibbonActionID`) VALUES (NULL , '1', (SELECT gibbonActionID FROM gibbonaction JOIN gibbonmodule ON (gibbonaction.gibbonModuleID=gibbonmodule.gibbonModuleID) WHERE gibbonmodule.name='Timetable' AND gibbonaction.name='Manage Space Changes_allClasses'));end
INSERT INTO `gibbonaction` (`gibbonActionID`, `gibbonModuleID`, `name`, `precedence`, `category`, `description`, `URLList`, `entryURL`, `entrySidebar`, `defaultPermissionAdmin`, `defaultPermissionTeacher`, `defaultPermissionStudent`, `defaultPermissionParent`, `defaultPermissionSupport`, `categoryPermissionStaff`, `categoryPermissionStudent`, `categoryPermissionParent`, `categoryPermissionOther`) VALUES (NULL, (SELECT gibbonModuleID FROM gibbonmodule WHERE name='Timetable'), 'Manage Space Changes_myClasses', 0, 'Spaces', 'Allows a user to create and manage one-off location changes for their own classes within the timetable.', 'spaceChange_manage.php,spaceChange_manage_add.php,spaceChange_manage_edit.php,spaceChange_manage_delete.php','spaceChange_manage.php', 'Y', 'N', 'Y', 'N', 'N', 'N', 'Y', 'N', 'N', 'N');end
INSERT INTO `gibbonpermission` (`permissionID` ,`gibbonRoleID` ,`gibbonActionID`) VALUES (NULL , '2', (SELECT gibbonActionID FROM gibbonaction JOIN gibbonmodule ON (gibbonaction.gibbonModuleID=gibbonmodule.gibbonModuleID) WHERE gibbonmodule.name='Timetable' AND gibbonaction.name='Manage Space Changes_myClasses'));end
CREATE TABLE `gibbonttspacebooking` (  `gibbonTTSpaceBookingID` int(12) unsigned zerofill NOT NULL AUTO_INCREMENT,  `gibbonSpaceID` int(5) unsigned zerofill NOT NULL,  `gibbonPersonID` int(10) unsigned zerofill NOT NULL,  `date` date NOT NULL,  `timeStart` time NOT NULL,  `timeEnd` time NOT NULL,  PRIMARY KEY (`gibbonTTSpaceBookingID`)) ENGINE=MyISAM DEFAULT CHARSET=utf8 ;end
ALTER TABLE `gibbonperson` ADD `viewCalendarSpaceBooking` ENUM('Y','N') NOT NULL DEFAULT 'N' AFTER `viewCalendarPersonal`;end
INSERT INTO `gibbonaction` (`gibbonActionID`, `gibbonModuleID`, `name`, `precedence`, `category`, `description`, `URLList`, `entryURL`, `entrySidebar`, `defaultPermissionAdmin`, `defaultPermissionTeacher`, `defaultPermissionStudent`, `defaultPermissionParent`, `defaultPermissionSupport`, `categoryPermissionStaff`, `categoryPermissionStudent`, `categoryPermissionParent`, `categoryPermissionOther`) VALUES (NULL, (SELECT gibbonModuleID FROM gibbonmodule WHERE name='Timetable'), 'Manage Space Bookings_allBookings', 0, 'Spaces', 'Allows a user to book a room for on-off use, and manage bookings made by all other users.', 'spaceBooking_manage.php,spaceBooking_manage_add.php,spaceBooking_manage_edit.php,spaceBooking_manage_delete.php','spaceBooking_manage.php', 'Y', 'Y', 'N', 'N', 'N', 'N', 'Y', 'N', 'N', 'N');end
INSERT INTO `gibbonpermission` (`permissionID` ,`gibbonRoleID` ,`gibbonActionID`) VALUES (NULL , '1', (SELECT gibbonActionID FROM gibbonaction JOIN gibbonmodule ON (gibbonaction.gibbonModuleID=gibbonmodule.gibbonModuleID) WHERE gibbonmodule.name='Timetable' AND gibbonaction.name='Manage Space Bookings_allBookings'));end
INSERT INTO `gibbonaction` (`gibbonActionID`, `gibbonModuleID`, `name`, `precedence`, `category`, `description`, `URLList`, `entryURL`, `entrySidebar`, `defaultPermissionAdmin`, `defaultPermissionTeacher`, `defaultPermissionStudent`, `defaultPermissionParent`, `defaultPermissionSupport`, `categoryPermissionStaff`, `categoryPermissionStudent`, `categoryPermissionParent`, `categoryPermissionOther`) VALUES (NULL, (SELECT gibbonModuleID FROM gibbonmodule WHERE name='Timetable'), 'Manage Space Bookings_myBookings', 0, 'Spaces', 'Allows a user to book a room for on-off use, and manage their own bookings.', 'spaceBooking_manage.php,spaceBooking_manage_add.php,spaceBooking_manage_edit.php,spaceBooking_manage_delete.php','spaceBooking_manage.php', 'Y', 'N', 'Y', 'N', 'N', 'N', 'Y', 'N', 'N', 'N');end
INSERT INTO `gibbonpermission` (`permissionID` ,`gibbonRoleID` ,`gibbonActionID`) VALUES (NULL , '2', (SELECT gibbonActionID FROM gibbonaction JOIN gibbonmodule ON (gibbonaction.gibbonModuleID=gibbonmodule.gibbonModuleID) WHERE gibbonmodule.name='Timetable' AND gibbonaction.name='Manage Space Bookings_myBookings'));end
INSERT INTO `gibboni18n` (`code`, `name`, `active`, `systemDefault`, `maintainerName`, `maintainerWebsite`, `dateFormat`, `dateFormatRegEx`, `dateFormatPHP`) VALUES ('es_MX', 'Español - México', 'Y', 'N', 'Guillermo Bautista Fuerte.', '', 'dd/mm/yyyy', '/^(0[1-9]|[12][0-9]|3[01])[- /.](0[1-9]|1[012])[- /.](19|20)\\\d\\\d$/i', 'd/m/Y');end
DELETE FROM gibboni18n WHERE code='es_MX';end
UPDATE `gibboni18n` SET `code` = 'es', `name` = 'Español', active='Y' WHERE `code`='es_ES';end
UPDATE `gibboni18n` SET `code` = 'es_ES' WHERE `code`='es';end
" ;

//v8.3.00
$count++ ;
$sql[$count][0]="8.3.00" ;
$sql[$count][1]="
ALTER TABLE `gibbonrollgroup` ADD `website` VARCHAR(255) NOT NULL ;end
INSERT INTO `gibboni18n` (`code`, `name`, `active`, `systemDefault`, `maintainerName`, `maintainerWebsite`, `dateFormat`, `dateFormatRegEx`, `dateFormatPHP`) VALUES ('id_ID', 'Bahasa Indonesia - Indonesia', 'N', 'N', 'Adrian Hodson', '', 'dd/mm/yyyy', '/^(0[1-9]|[12][0-9]|3[01])[- /.](0[1-9]|1[012])[- /.](19|20)\\\d\\\d$/i', 'd/m/Y');end
UPDATE gibbonaction SET URLList='planner.php, planner_view_full.php, planner_deadlines.php, planner_view_full_post.php, planner_unitOverview.php' WHERE name='Lesson Planner_viewMyChildrensClasses' AND gibbonModuleID=(SELECT gibbonModuleID FROM gibbonmodule WHERE name='Planner');end
UPDATE gibbonaction SET URLList='planner.php, planner_view_full.php, planner_add.php, planner_edit.php, planner_delete.php, planner_deadlines.php, planner_duplicate.php, planner_view_full_post.php, planner_view_full_submit_edit.php, planner_bump.php, planner_unitOverview.php' WHERE name='Lesson Planner_viewAllEditMyClasses' AND gibbonModuleID=(SELECT gibbonModuleID FROM gibbonmodule WHERE name='Planner');end
UPDATE gibbonaction SET URLList='planner.php, planner_view_full.php, planner_deadlines.php, planner_view_full_post.php, planner_unitOverview.php' WHERE name='Lesson Planner_viewMyClasses' AND gibbonModuleID=(SELECT gibbonModuleID FROM gibbonmodule WHERE name='Planner');end
UPDATE gibbonaction SET URLList='planner.php, planner_view_full.php, planner_add.php, planner_edit.php, planner_delete.php, planner_deadlines.php, planner_duplicate.php, planner_view_full_post.php, planner_view_full_submit_edit.php, planner_bump.php, planner_unitOverview.php' WHERE name='Lesson Planner_viewEditAllClasses' AND gibbonModuleID=(SELECT gibbonModuleID FROM gibbonmodule WHERE name='Planner');end
INSERT INTO `gibbonaction` (`gibbonActionID`, `gibbonModuleID`, `name`, `precedence`, `category`, `description`, `URLList`, `entryURL`, `entrySidebar`, `defaultPermissionAdmin`, `defaultPermissionTeacher`, `defaultPermissionStudent`, `defaultPermissionParent`, `defaultPermissionSupport`, `categoryPermissionStaff`, `categoryPermissionStudent`, `categoryPermissionParent`, `categoryPermissionOther`) VALUES (NULL, (SELECT gibbonModuleID FROM gibbonmodule WHERE name='Library'), 'Import Records', 0, 'Catalog', 'Import records of different types (e.g. Print Publications, Computer, etc)', 'library_import.php','library_import.php', 'Y', 'Y', 'N', 'N', 'N', 'N', 'Y', 'N', 'N', 'N');end
INSERT INTO `gibbonpermission` (`permissionID` ,`gibbonRoleID` ,`gibbonActionID`) VALUES (NULL , '1', (SELECT gibbonActionID FROM gibbonaction JOIN gibbonmodule ON (gibbonaction.gibbonModuleID=gibbonmodule.gibbonModuleID) WHERE gibbonmodule.name='Library' AND gibbonaction.name='Import Records'));end
INSERT INTO `gibbonsetting` (`gibbonSystemSettingsID` ,`scope` ,`name` ,`nameDisplay` ,`description` ,`value`)VALUES (NULL , 'Planner', 'parentWeeklyEmailSummaryIncludeBehaviour', 'Parent Weekly Email Summary Include Behaviour', 'Should behaviour information be included in the weekly planner email summary that goes out to parents?', 'Y');end
INSERT INTO `gibbonlibrarytype` (`gibbonLibraryTypeID`, `name`, `active`, `fields`) VALUES (NULL, 'Software', 'Y', 'a:7:{i:0;a:6:{s:4:\"name\";s:7:\"Version\";s:11:\"description\";s:0:\"\";s:4:\"type\";s:4:\"Text\";s:7:\"options\";s:2:\"50\";s:7:\"default\";s:0:\"\";s:8:\"required\";s:1:\"N\";}i:1;a:6:{s:4:\"name\";s:16:\"Operating System\";s:11:\"description\";s:0:\"\";s:4:\"type\";s:4:\"Text\";s:7:\"options\";s:2:\"50\";s:7:\"default\";s:0:\"\";s:8:\"required\";s:1:\"N\";}i:2;a:6:{s:4:\"name\";s:12:\"License Type\";s:11:\"description\";s:48:\"E.g. Open Source, Site License, number of users.\";s:4:\"type\";s:4:\"Text\";s:7:\"options\";s:3:\"255\";s:7:\"default\";s:0:\"\";s:8:\"required\";s:1:\"N\";}i:3;a:6:{s:4:\"name\";s:12:\"License Name\";s:11:\"description\";s:55:\"If the software is registered, who is it registered to?\";s:4:\"type\";s:4:\"Text\";s:7:\"options\";s:3:\"255\";s:7:\"default\";s:0:\"\";s:8:\"required\";s:1:\"N\";}i:4;a:6:{s:4:\"name\";s:21:\"License Serial Number\";s:11:\"description\";s:0:\"\";s:4:\"type\";s:4:\"Text\";s:7:\"options\";s:3:\"255\";s:7:\"default\";s:0:\"\";s:8:\"required\";s:1:\"N\";}i:5;a:6:{s:4:\"name\";s:14:\"License Expiry\";s:11:\"description\";s:19:\"Format: dd/mm/yyyy.\";s:4:\"type\";s:4:\"Date\";s:7:\"options\";s:0:\"\";s:7:\"default\";s:0:\"\";s:8:\"required\";s:1:\"N\";}i:6;a:6:{s:4:\"name\";s:23:\"License Management Link\";s:11:\"description\";s:34:\"Link to web-based management tool.\";s:4:\"type\";s:3:\"URL\";s:7:\"options\";s:3:\"255\";s:7:\"default\";s:0:\"\";s:8:\"required\";s:1:\"N\";}}');end
UPDATE gibbonmodule SET category='Assess' WHERE category='Assessment';end
UPDATE gibbonmodule SET category='Learn' WHERE category='Learning';end
ALTER TABLE `gibbonunitblock` ADD `gibbonOutcomeIDList` TEXT NOT NULL ;end
ALTER TABLE `gibboni18n` ADD `rtl` ENUM('Y','N') NOT NULL DEFAULT 'N' ;end
ALTER TABLE `gibboni18n` CHANGE `name` `name` VARCHAR(100) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL;end
INSERT INTO `gibboni18n` (`gibboni18nID`, `code`, `name`, `active`, `systemDefault`, `maintainerName`, `maintainerWebsite`, `dateFormat`, `dateFormatRegEx`, `dateFormatPHP`, `rtl`) VALUES (NULL, 'ar_SA', 'Arabic (العربية) - Saudi Arabia (المملكة العربية السعودية)', 'N', 'N', 'Abdul Rahman Yousef', '', 'dd/mm/yyyy', '/^(0[1-9]|[12][0-9]|3[01])[- /.](0[1-9]|1[012])[- /.](19|20)\\\d\\\d$/i', 'd/m/Y', 'Y');end
UPDATE `gibboni18n` SET `name` = 'العربية - المملكة العربية السعودية' WHERE `code`='ar_SA';end
ALTER TABLE `gibbonunitclassblock` ADD `gibbonOutcomeIDList` TEXT NOT NULL ;end
INSERT INTO `gibbonaction` (`gibbonActionID`, `gibbonModuleID`, `name`, `precedence`, `category`, `description`, `URLList`, `entryURL`, `entrySidebar`, `defaultPermissionAdmin`, `defaultPermissionTeacher`, `defaultPermissionStudent`, `defaultPermissionParent`, `defaultPermissionSupport`, `categoryPermissionStaff`, `categoryPermissionStudent`, `categoryPermissionParent`, `categoryPermissionOther`) VALUES (NULL, (SELECT gibbonModuleID FROM gibbonmodule WHERE name='Planner'), 'Outcomes By Course', 0, 'Curriculum Mapping', 'This view gives an overview of which whole school and learning area outcomes are covered by classes in a given course, allowing for curriculum mapping by outcome and course.', 'curriculumMapping_outcomesByCourse.php','curriculumMapping_outcomesByCourse.php', 'Y', 'Y', 'N', 'N', 'N', 'N', 'Y', 'Y', 'Y', 'N');end
INSERT INTO `gibbonpermission` (`permissionID` ,`gibbonRoleID` ,`gibbonActionID`) VALUES (NULL , '1', (SELECT gibbonActionID FROM gibbonaction JOIN gibbonmodule ON (gibbonaction.gibbonModuleID=gibbonmodule.gibbonModuleID) WHERE gibbonmodule.name='Planner' AND gibbonaction.name='Outcomes By Course'));end
INSERT INTO `gibbonpermission` (`permissionID` ,`gibbonRoleID` ,`gibbonActionID`) VALUES (NULL , '2', (SELECT gibbonActionID FROM gibbonaction JOIN gibbonmodule ON (gibbonaction.gibbonModuleID=gibbonmodule.gibbonModuleID) WHERE gibbonmodule.name='Planner' AND gibbonaction.name='Outcomes By Course'));end
UPDATE gibbonaction SET name='Manage Finance Settings', gibbonModuleID=(SELECT gibbonModuleID FROM gibbonmodule WHERE name='School Admin'), category='Other' WHERE name='Invoice & Receipt Settings' AND gibbonModuleID=(SELECT gibbonModuleID FROM gibbonmodule WHERE name='Finance');end
UPDATE gibbonaction SET URLList='financeSettings.php', entryURL='financeSettings.php' WHERE name='Manage Finance Settings' AND gibbonModuleID=(SELECT gibbonModuleID FROM gibbonmodule WHERE name='School Admin');end
INSERT INTO `gibbonsetting` (`gibbonSystemSettingsID` ,`scope` ,`name` ,`nameDisplay` ,`description` ,`value`)VALUES (NULL , 'Finance', 'financeOnlinePaymentEnabled', 'Enable Online Payment', 'Should invoices be payable online, via an encrypted link in the invoice? Requires correctly configured payment gateway in System Settings.', 'N');end
INSERT INTO `gibbonsetting` (`gibbonSystemSettingsID` ,`scope` ,`name` ,`nameDisplay` ,`description` ,`value`)VALUES (NULL , 'Finance', 'financeOnlinePaymentThreshold', 'Online Payment Threshold', 'If invoices are payable online, what is the maximum payment allowed? Useful for controlling payment fees. No value means unlimited.', '');end
ALTER TABLE `gibbonfinanceinvoice` ADD `key` VARCHAR(40) NOT NULL AFTER `notes`;end
ALTER TABLE `gibbonfinanceinvoice` ADD `gibbonPaymentID` INT(14) UNSIGNED ZEROFILL NULL DEFAULT NULL AFTER `paidAmount`;end
";

//v9.0.00
$count++ ;
$sql[$count][0]="9.0.00" ;
$sql[$count][1]="
UPDATE gibboni18n SET maintainerName='Guillermo Bautista Fuerte', maintainerWebsite='' WHERE code='es_ES';end
ALTER TABLE `gibbonstudentnote` ADD `title` VARCHAR(50) NOT NULL AFTER `gibbonStudentNoteCategoryID`;end
INSERT INTO `gibboni18n` (`code`, `name`, `active`, `systemDefault`, `maintainerName`, `maintainerWebsite`, `dateFormat`, `dateFormatRegEx`, `dateFormatPHP`) VALUES ('fr_FR', 'Français - France', 'N', 'N', 'Jean-Baptiste Tamegnon', '', 'dd/mm/yyyy', '/^(0[1-9]|[12][0-9]|3[01])[- /.](0[1-9]|1[012])[- /.](19|20)\\\d\\\d$/i', 'd/m/Y');end
ALTER TABLE `gibbonexternalassessment` ADD `allowFileUpload` ENUM('Y','N') NOT NULL DEFAULT 'N' ;end
ALTER TABLE `gibbonexternalassessmentstudent` ADD `attachment` VARCHAR(255) NOT NULL ;end
ALTER TABLE `gibbonstudentenrolment` ADD `rollOrder` INT(2) NULL DEFAULT NULL ;end
ALTER TABLE `gibbonmarkbookcolumn` CHANGE `description` `description` TEXT CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL;end
DELETE FROM gibbontheme WHERE name='Default' OR name='Olden';end
INSERT INTO `gibbontheme` (`gibbonThemeID` ,`name` ,`description` ,`active` ,`version` ,`author` ,`url`)VALUES (NULL , 'Default', 'Gibbon\'s 2015 look and feel.', 'Y', '1.0.00', 'Ross Parker', 'http://rossparker.org');end
UPDATE gibbonsetting SET description='Relative path to site logo (400 x 100px)' WHERE scope='System' AND name='organisationLogo' ;end
DELETE FROM gibbontheme WHERE NOT name='Default';end
INSERT INTO `gibbonsetting` (`gibbonSystemSettingsID` ,`scope` ,`name` ,`nameDisplay` ,`description` ,`value`)VALUES (NULL , 'Departments', 'makeDepartmentsPublic', 'Make Departments Public', 'Should department information be made available to the public, via the Gibbon homeoage?', 'N');end
ALTER TABLE `gibbonfamilyupdate` ADD `gibbonSchoolYearID` INT(3) UNSIGNED ZEROFILL NULL DEFAULT NULL AFTER `gibbonFamilyUpdateID`;end
ALTER TABLE `gibbonfinanceinvoiceeupdate` ADD `gibbonSchoolYearID` INT(3) UNSIGNED ZEROFILL NULL DEFAULT NULL AFTER `gibbonFinanceInvoiceeUpdateID`;end
ALTER TABLE `gibbonpersonmedicalupdate` ADD `gibbonSchoolYearID` INT(3) UNSIGNED ZEROFILL NULL DEFAULT NULL AFTER `gibbonPersonMedicalUpdateID`;end
ALTER TABLE `gibbonpersonupdate` ADD `gibbonSchoolYearID` INT(3) UNSIGNED ZEROFILL NULL DEFAULT NULL AFTER `gibbonPersonUpdateID`;end
UPDATE gibbonfamilyupdate SET gibbonSchoolYearID=(SELECT gibbonSchoolYearID FROM gibbonschoolyear WHERE status='Current') WHERE timestamp>='2014-07-01 00:00:00';end
UPDATE gibbonfamilyupdate SET gibbonSchoolYearID=(SELECT gibbonSchoolYearID FROM gibbonschoolyear WHERE status='Past' ORDER BY sequenceNumber DESC LIMIT 0,1) WHERE timestamp<'2014-07-01 00:00:00';end
UPDATE gibbonfinanceinvoiceeupdate SET gibbonSchoolYearID=(SELECT gibbonSchoolYearID FROM gibbonschoolyear WHERE status='Current') WHERE timestamp>='2014-07-01 00:00:00';end
UPDATE gibbonfinanceinvoiceeupdate SET gibbonSchoolYearID=(SELECT gibbonSchoolYearID FROM gibbonschoolyear WHERE status='Past' ORDER BY sequenceNumber DESC LIMIT 0,1) WHERE timestamp<'2014-07-01 00:00:00';end
UPDATE gibbonpersonmedicalupdate SET gibbonSchoolYearID=(SELECT gibbonSchoolYearID FROM gibbonschoolyear WHERE status='Current') WHERE timestamp>='2014-07-01 00:00:00';end
UPDATE gibbonpersonmedicalupdate SET gibbonSchoolYearID=(SELECT gibbonSchoolYearID FROM gibbonschoolyear WHERE status='Past' ORDER BY sequenceNumber DESC LIMIT 0,1) WHERE timestamp<'2014-07-01 00:00:00';end
UPDATE gibbonpersonupdate SET gibbonSchoolYearID=(SELECT gibbonSchoolYearID FROM gibbonschoolyear WHERE status='Current') WHERE timestamp>='2014-07-01 00:00:00';end
UPDATE gibbonpersonupdate SET gibbonSchoolYearID=(SELECT gibbonSchoolYearID FROM gibbonschoolyear WHERE status='Past' ORDER BY sequenceNumber DESC LIMIT 0,1) WHERE timestamp<'2014-07-01 00:00:00';end
UPDATE gibbonperson SET calendarFeedPersonal='';end
UPDATE gibbonsetting SET scope='System' WHERE name LIKE 'google%';end
UPDATE gibbonsetting SET nameDisplay='Google Integration', description='Enable Gibbon-wide integration with the Google APIs?' WHERE name='googleOAuth' AND scope='System';end
UPDATE gibbonsetting SET nameDisplay='School Google Calendar ID', description='Google Calendar ID for your school calendar. Only enables timetable integration when logging in via Google.' WHERE name='calendarFeed' AND scope='System';end
ALTER TABLE `gibbonperson` CHANGE `ethnicity` `ethnicity` VARCHAR(255) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL;end
ALTER TABLE `gibbonpersonupdate` CHANGE `ethnicity` `ethnicity` VARCHAR(255) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL;end
ALTER TABLE `gibbonperson` ADD `nationalIDCardScan` VARCHAR(255) NOT NULL AFTER `nationalIDCardNumber`;end
ALTER TABLE `gibbonperson` ADD `citizenship1PassportScan` VARCHAR(255) NOT NULL AFTER `citizenship1Passport`;end
ALTER TABLE `gibbonperson` ADD `googleAPIRefreshToken` VARCHAR(255) NOT NULL ;end
INSERT INTO `gibbonsetting` (`gibbonSystemSettingsID` ,`scope` ,`name` ,`nameDisplay` ,`description` ,`value`)VALUES (NULL , 'System', 'sessionDuration', 'Session Duration', 'Time, in seconds, before system logs a user out. Should be less than PHP\'s session.gc_maxlifetime option.', '1200');end
UPDATE gibbonsetting SET value='themes/Default/img/logo.png' WHERE value='themes/Default/img/logo.jpg' AND scope='System' AND name='organisationLogo';end
ALTER TABLE `gibbonperson` ADD `receiveNoticiationEmails` ENUM('N','Y') NOT NULL DEFAULT 'N' ;end
INSERT INTO `gibbonsetting` (`gibbonSystemSettingsID` ,`scope` ,`name` ,`nameDisplay` ,`description` ,`value`)VALUES (NULL , 'Planner', 'makeUnitsPublic', 'Make Units Public', 'Enables a public listing of units, with teachers able to opt in to share units.', 'N');end
ALTER TABLE `gibbonunit` ADD `license` VARCHAR(50) NULL DEFAULT NULL AFTER `embeddable`, ADD `sharedPublic` ENUM('Y','N') NULL DEFAULT NULL AFTER `license`;end
UPDATE gibboni18n SET maintainerName='Jasmine Chan & Charlie Chow' WHERE code='zh_HK';end
ALTER TABLE `gibbonhook` CHANGE `type` `type` ENUM('Public Home Page','Student Profile','Unit') CHARACTER SET utf8 COLLATE utf8_general_ci NULL DEFAULT NULL;end
UPDATE gibboni18n SET maintainerName='Dicky Widhyatmoko' WHERE code='id_ID';end
ALTER TABLE gibbonsetting DROP INDEX name;end
ALTER TABLE gibbonsetting DROP INDEX nameDisplay;end
ALTER TABLE gibbonsetting ADD UNIQUE (scope, nameDisplay) COMMENT '';end
ALTER TABLE gibbonsetting ADD UNIQUE (scope,name) COMMENT '';end
ALTER TABLE `gibbonmodule` CHANGE `description` `description` VARCHAR(255) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL;end
UPDATE gibbonsetting SET value='strong,em,span,p,address,pre,h1,h2,h3,h4,h5,h6,table,thead,tbody,tfoot,tr,td,ol,ul,li,blockquote,a,img,video,source,hr,iframe,embed' WHERE name='allowableHTML' AND scope='System';end
UPDATE gibbonsetting SET value='br,strong[*],em[*],span[*],p[*],address[*],pre[*],h1[*],h2[*],h3[*],h4[*],h5[*],h6[*],table[*],thead[*],tbody[*],tfoot[*],tr[*],td[*],ol[*],ul[*],li[*],blockquote[*],a[*],img[*],video[*],source[*],hr[*],iframe[*],embed[*]' WHERE name='allowableHTML' AND scope='System';end
UPDATE gibboni18n SET active='Y' WHERE code='zh_HK';end
";

?>